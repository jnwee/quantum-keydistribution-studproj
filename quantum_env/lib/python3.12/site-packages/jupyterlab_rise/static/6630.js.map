{"version":3,"file":"6630.bundle.js","mappings":"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","sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/celldragutils.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/collapser.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/headerfooter.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/inputarea.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/attachments/lib/model.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/model.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/placeholder.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/searchprovider.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/resizeHandle.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@jupyterlab/cells/lib/widget.js"],"sourcesContent":["/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { h, VirtualDOM } from '@lumino/virtualdom';\n/**\n * Constants for drag\n */\n/**\n * The threshold in pixels to start a drag event.\n */\nconst DRAG_THRESHOLD = 5;\n/**\n * The class name added to drag images.\n */\nconst DRAG_IMAGE_CLASS = 'jp-dragImage';\n/**\n * The class name added to singular drag images\n */\nconst SINGLE_DRAG_IMAGE_CLASS = 'jp-dragImage-singlePrompt';\n/**\n * The class name added to the drag image cell content.\n */\nconst CELL_DRAG_CONTENT_CLASS = 'jp-dragImage-content';\n/**\n * The class name added to the drag image cell content.\n */\nconst CELL_DRAG_PROMPT_CLASS = 'jp-dragImage-prompt';\n/**\n * The class name added to the drag image cell content.\n */\nconst CELL_DRAG_MULTIPLE_BACK = 'jp-dragImage-multipleBack';\nexport var CellDragUtils;\n(function (CellDragUtils) {\n    /**\n     * Find the cell index containing the target html element.\n     * This function traces up the DOM hierarchy to find the root cell\n     * node. Then find the corresponding child and select it.\n     *\n     * @param node - the cell node or a child of the cell node.\n     * @param cells - an iterable of Cells\n     * @param isCellNode - a function that takes in a node and checks if\n     * it is a cell node.\n     *\n     * @returns index of the cell we're looking for. Returns -1 if\n     * the cell is not founds\n     */\n    function findCell(node, cells, isCellNode) {\n        let cellIndex = -1;\n        while (node && node.parentElement) {\n            if (isCellNode(node)) {\n                let index = -1;\n                for (const cell of cells) {\n                    if (cell.node === node) {\n                        cellIndex = ++index;\n                        break;\n                    }\n                }\n                break;\n            }\n            node = node.parentElement;\n        }\n        return cellIndex;\n    }\n    CellDragUtils.findCell = findCell;\n    /**\n     * Detect which part of the cell triggered the MouseEvent\n     *\n     * @param cell - The cell which contains the MouseEvent's target\n     * @param target - The DOM node which triggered the MouseEvent\n     */\n    function detectTargetArea(cell, target) {\n        var _a, _b;\n        let targetArea;\n        if (cell) {\n            if ((_a = cell.editorWidget) === null || _a === void 0 ? void 0 : _a.node.contains(target)) {\n                targetArea = 'input';\n            }\n            else if ((_b = cell.promptNode) === null || _b === void 0 ? void 0 : _b.contains(target)) {\n                targetArea = 'prompt';\n            }\n            else {\n                targetArea = 'cell';\n            }\n        }\n        else {\n            targetArea = 'unknown';\n        }\n        return targetArea;\n    }\n    CellDragUtils.detectTargetArea = detectTargetArea;\n    /**\n     * Detect if a drag event should be started. This is down if the\n     * mouse is moved beyond a certain distance (DRAG_THRESHOLD).\n     *\n     * @param prevX - X Coordinate of the mouse pointer during the mousedown event\n     * @param prevY - Y Coordinate of the mouse pointer during the mousedown event\n     * @param nextX - Current X Coordinate of the mouse pointer\n     * @param nextY - Current Y Coordinate of the mouse pointer\n     */\n    function shouldStartDrag(prevX, prevY, nextX, nextY) {\n        const dx = Math.abs(nextX - prevX);\n        const dy = Math.abs(nextY - prevY);\n        return dx >= DRAG_THRESHOLD || dy >= DRAG_THRESHOLD;\n    }\n    CellDragUtils.shouldStartDrag = shouldStartDrag;\n    /**\n     * Create an image for the cell(s) to be dragged\n     *\n     * @param activeCell - The cell from where the drag event is triggered\n     * @param selectedCells - The cells to be dragged\n     */\n    function createCellDragImage(activeCell, selectedCells) {\n        const count = selectedCells.length;\n        let promptNumber;\n        if (activeCell.model.type === 'code') {\n            const executionCount = activeCell.model\n                .executionCount;\n            promptNumber = ' ';\n            if (executionCount) {\n                promptNumber = executionCount.toString();\n            }\n        }\n        else {\n            promptNumber = '';\n        }\n        const cellContent = activeCell.model.sharedModel\n            .getSource()\n            .split('\\n')[0]\n            .slice(0, 26);\n        if (count > 1) {\n            if (promptNumber !== '') {\n                return VirtualDOM.realize(h.div(h.div({ className: DRAG_IMAGE_CLASS }, h.span({ className: CELL_DRAG_PROMPT_CLASS }, '[' + promptNumber + ']:'), h.span({ className: CELL_DRAG_CONTENT_CLASS }, cellContent)), h.div({ className: CELL_DRAG_MULTIPLE_BACK }, '')));\n            }\n            else {\n                return VirtualDOM.realize(h.div(h.div({ className: DRAG_IMAGE_CLASS }, h.span({ className: CELL_DRAG_PROMPT_CLASS }), h.span({ className: CELL_DRAG_CONTENT_CLASS }, cellContent)), h.div({ className: CELL_DRAG_MULTIPLE_BACK }, '')));\n            }\n        }\n        else {\n            if (promptNumber !== '') {\n                return VirtualDOM.realize(h.div(h.div({ className: `${DRAG_IMAGE_CLASS} ${SINGLE_DRAG_IMAGE_CLASS}` }, h.span({ className: CELL_DRAG_PROMPT_CLASS }, '[' + promptNumber + ']:'), h.span({ className: CELL_DRAG_CONTENT_CLASS }, cellContent))));\n            }\n            else {\n                return VirtualDOM.realize(h.div(h.div({ className: `${DRAG_IMAGE_CLASS} ${SINGLE_DRAG_IMAGE_CLASS}` }, h.span({ className: CELL_DRAG_PROMPT_CLASS }), h.span({ className: CELL_DRAG_CONTENT_CLASS }, cellContent))));\n            }\n        }\n    }\n    CellDragUtils.createCellDragImage = createCellDragImage;\n})(CellDragUtils || (CellDragUtils = {}));\n//# sourceMappingURL=celldragutils.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { ReactWidget } from '@jupyterlab/ui-components';\nimport { ElementExt } from '@lumino/domutils';\nimport * as React from 'react';\n/**\n * The CSS class added to all collapsers.\n */\nconst COLLAPSER_CLASS = 'jp-Collapser';\n/**\n * The CSS class added to the collapser child.\n */\nconst COLLAPSER_CHILD_CLASS = 'jp-Collapser-child';\n/**\n * The CSS class added to input collapsers.\n */\nconst INPUT_COLLAPSER = 'jp-InputCollapser';\n/**\n * The CSS class added to output collapsers.\n */\nconst OUTPUT_COLLAPSER = 'jp-OutputCollapser';\n/**\n * Abstract collapser base class.\n *\n * ### Notes\n * A collapser is a visible div to the left of a cell's\n * input/output that a user can click on to collapse the\n * input/output.\n */\nexport class Collapser extends ReactWidget {\n    /**\n     * Construct a new collapser.\n     */\n    constructor() {\n        super();\n        this.addClass(COLLAPSER_CLASS);\n    }\n    /**\n     * Is the input/output of the parent collapsed.\n     */\n    get collapsed() {\n        return false;\n    }\n    /**\n     * Render the collapser with the virtual DOM.\n     */\n    render() {\n        const childClass = COLLAPSER_CHILD_CLASS;\n        return React.createElement(\"div\", { className: childClass, onClick: e => this.handleClick(e) });\n    }\n}\n/**\n * A collapser subclass to collapse a cell's input area.\n */\nexport class InputCollapser extends Collapser {\n    /**\n     * Construct a new input collapser.\n     */\n    constructor() {\n        super();\n        this.addClass(INPUT_COLLAPSER);\n    }\n    /**\n     * Is the cell's input collapsed?\n     */\n    get collapsed() {\n        var _a;\n        const cell = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.parent;\n        if (cell) {\n            return cell.inputHidden;\n        }\n        else {\n            return false;\n        }\n    }\n    /**\n     * Handle a click event for the user to collapse the cell's input.\n     */\n    handleClick(e) {\n        var _a;\n        const cell = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.parent;\n        if (cell) {\n            cell.inputHidden = !cell.inputHidden;\n        }\n        /* We need this until we watch the cell state */\n        this.update();\n    }\n}\n/**\n * A collapser subclass to collapse a cell's output area.\n */\nexport class OutputCollapser extends Collapser {\n    /**\n     * Construct a new output collapser.\n     */\n    constructor() {\n        super();\n        this.addClass(OUTPUT_COLLAPSER);\n    }\n    /**\n     * Is the cell's output collapsed?\n     */\n    get collapsed() {\n        var _a;\n        const cell = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.parent;\n        if (cell) {\n            return cell.outputHidden;\n        }\n        else {\n            return false;\n        }\n    }\n    /**\n     * Handle a click event for the user to collapse the cell's output.\n     */\n    handleClick(e) {\n        var _a, _b;\n        const cell = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.parent;\n        if (cell) {\n            cell.outputHidden = !cell.outputHidden;\n            /* Scroll cell into view after output collapse */\n            if (cell.outputHidden) {\n                let area = (_b = cell.parent) === null || _b === void 0 ? void 0 : _b.node;\n                if (area) {\n                    ElementExt.scrollIntoViewIfNeeded(area, cell.node);\n                }\n            }\n        }\n        /* We need this until we watch the cell state */\n        this.update();\n    }\n}\n//# sourceMappingURL=collapser.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { Widget } from '@lumino/widgets';\n/**\n * The CSS class added to the cell header.\n */\nconst CELL_HEADER_CLASS = 'jp-CellHeader';\n/**\n * The CSS class added to the cell footer.\n */\nconst CELL_FOOTER_CLASS = 'jp-CellFooter';\n/**\n * Default implementation of a cell header.\n */\nexport class CellHeader extends Widget {\n    /**\n     * Construct a new cell header.\n     */\n    constructor() {\n        super();\n        this.addClass(CELL_HEADER_CLASS);\n    }\n}\n/**\n * Default implementation of a cell footer.\n */\nexport class CellFooter extends Widget {\n    /**\n     * Construct a new cell footer.\n     */\n    constructor() {\n        super();\n        this.addClass(CELL_FOOTER_CLASS);\n    }\n}\n//# sourceMappingURL=headerfooter.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { PanelLayout } from '@lumino/widgets';\nimport { Widget } from '@lumino/widgets';\nimport { CodeEditorWrapper } from '@jupyterlab/codeeditor';\n/**\n * The class name added to input area widgets.\n */\nconst INPUT_AREA_CLASS = 'jp-InputArea';\n/**\n * The class name added to the prompt area of cell.\n */\nconst INPUT_AREA_PROMPT_CLASS = 'jp-InputArea-prompt';\n/**\n * The class name added to OutputPrompt.\n */\nconst INPUT_PROMPT_CLASS = 'jp-InputPrompt';\n/**\n * The class name added to the editor area of the cell.\n */\nconst INPUT_AREA_EDITOR_CLASS = 'jp-InputArea-editor';\n/** ****************************************************************************\n * InputArea\n ******************************************************************************/\n/**\n * An input area widget, which hosts a prompt and an editor widget.\n */\nexport class InputArea extends Widget {\n    /**\n     * Construct an input area widget.\n     */\n    constructor(options) {\n        super();\n        this.addClass(INPUT_AREA_CLASS);\n        const { contentFactory, editorOptions, model } = options;\n        this.model = model;\n        this.contentFactory = contentFactory;\n        // Prompt\n        const prompt = (this._prompt = contentFactory.createInputPrompt());\n        prompt.addClass(INPUT_AREA_PROMPT_CLASS);\n        // Editor\n        const editor = (this._editor = new CodeEditorWrapper({\n            factory: contentFactory.editorFactory,\n            model,\n            editorOptions\n        }));\n        editor.addClass(INPUT_AREA_EDITOR_CLASS);\n        const layout = (this.layout = new PanelLayout());\n        layout.addWidget(prompt);\n        layout.addWidget(editor);\n    }\n    /**\n     * Get the CodeEditorWrapper used by the cell.\n     */\n    get editorWidget() {\n        return this._editor;\n    }\n    /**\n     * Get the CodeEditor used by the cell.\n     */\n    get editor() {\n        return this._editor.editor;\n    }\n    /**\n     * Get the prompt node used by the cell.\n     */\n    get promptNode() {\n        return this._prompt.node;\n    }\n    /**\n     * Get the rendered input area widget, if any.\n     */\n    get renderedInput() {\n        return this._rendered;\n    }\n    /**\n     * Render an input instead of the text editor.\n     */\n    renderInput(widget) {\n        const layout = this.layout;\n        if (this._rendered) {\n            this._rendered.parent = null;\n        }\n        this._editor.hide();\n        this._rendered = widget;\n        layout.addWidget(widget);\n    }\n    /**\n     * Show the text editor.\n     */\n    showEditor() {\n        if (this._rendered) {\n            this._rendered.parent = null;\n        }\n        this._editor.show();\n    }\n    /**\n     * Set the prompt of the input area.\n     */\n    setPrompt(value) {\n        this._prompt.executionCount = value;\n    }\n    /**\n     * Dispose of the resources held by the widget.\n     */\n    dispose() {\n        // Do nothing if already disposed.\n        if (this.isDisposed) {\n            return;\n        }\n        this._prompt = null;\n        this._editor = null;\n        this._rendered = null;\n        super.dispose();\n    }\n}\n/**\n * A namespace for `InputArea` statics.\n */\n(function (InputArea) {\n    /**\n     * Default implementation of `IContentFactory`.\n     *\n     * This defaults to using an `editorFactory` based on CodeMirror.\n     */\n    class ContentFactory {\n        /**\n         * Construct a `ContentFactory`.\n         */\n        constructor(options) {\n            this._editor = options.editorFactory;\n        }\n        /**\n         * Return the `CodeEditor.Factory` being used.\n         */\n        get editorFactory() {\n            return this._editor;\n        }\n        /**\n         * Create an input prompt.\n         */\n        createInputPrompt() {\n            return new InputPrompt();\n        }\n    }\n    InputArea.ContentFactory = ContentFactory;\n})(InputArea || (InputArea = {}));\n/**\n * The default input prompt implementation.\n */\nexport class InputPrompt extends Widget {\n    /*\n     * Create an output prompt widget.\n     */\n    constructor() {\n        super();\n        this._executionCount = null;\n        this.addClass(INPUT_PROMPT_CLASS);\n    }\n    /**\n     * The execution count for the prompt.\n     */\n    get executionCount() {\n        return this._executionCount;\n    }\n    set executionCount(value) {\n        this._executionCount = value;\n        if (value === null) {\n            this.node.textContent = ' ';\n        }\n        else {\n            this.node.textContent = `[${value || ' '}]:`;\n        }\n    }\n}\n//# sourceMappingURL=inputarea.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { ObservableMap } from '@jupyterlab/observables';\nimport { AttachmentModel, imageRendererFactory } from '@jupyterlab/rendermime';\nimport { Signal } from '@lumino/signaling';\n/**\n * The default implementation of the IAttachmentsModel.\n */\nexport class AttachmentsModel {\n    /**\n     * Construct a new observable outputs instance.\n     */\n    constructor(options) {\n        var _a;\n        this._map = new ObservableMap();\n        this._isDisposed = false;\n        this._stateChanged = new Signal(this);\n        this._changed = new Signal(this);\n        this._serialized = null;\n        this._changeGuard = false;\n        this.contentFactory =\n            (_a = options.contentFactory) !== null && _a !== void 0 ? _a : AttachmentsModel.defaultContentFactory;\n        if (options.values) {\n            for (const key of Object.keys(options.values)) {\n                if (options.values[key] !== undefined) {\n                    this.set(key, options.values[key]);\n                }\n            }\n        }\n        this._map.changed.connect(this._onMapChanged, this);\n    }\n    /**\n     * A signal emitted when the model state changes.\n     */\n    get stateChanged() {\n        return this._stateChanged;\n    }\n    /**\n     * A signal emitted when the model changes.\n     */\n    get changed() {\n        return this._changed;\n    }\n    /**\n     * The keys of the attachments in the model.\n     */\n    get keys() {\n        return this._map.keys();\n    }\n    /**\n     * Get the length of the items in the model.\n     */\n    get length() {\n        return this._map.keys().length;\n    }\n    /**\n     * Test whether the model is disposed.\n     */\n    get isDisposed() {\n        return this._isDisposed;\n    }\n    /**\n     * Dispose of the resources used by the model.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._map.dispose();\n        Signal.clearData(this);\n    }\n    /**\n     * Whether the specified key is set.\n     */\n    has(key) {\n        return this._map.has(key);\n    }\n    /**\n     * Get an item at the specified key.\n     */\n    get(key) {\n        return this._map.get(key);\n    }\n    /**\n     * Set the value at the specified key.\n     */\n    set(key, value) {\n        // Normalize stream data.\n        const item = this._createItem({ value });\n        this._map.set(key, item);\n    }\n    /**\n     * Remove the attachment whose name is the specified key\n     */\n    remove(key) {\n        this._map.delete(key);\n    }\n    /**\n     * Clear all of the attachments.\n     */\n    clear() {\n        this._map.values().forEach((item) => {\n            item.dispose();\n        });\n        this._map.clear();\n    }\n    /**\n     * Deserialize the model from JSON.\n     *\n     * #### Notes\n     * This will clear any existing data.\n     */\n    fromJSON(values) {\n        this.clear();\n        Object.keys(values).forEach(key => {\n            if (values[key] !== undefined) {\n                this.set(key, values[key]);\n            }\n        });\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        const ret = {};\n        for (const key of this._map.keys()) {\n            ret[key] = this._map.get(key).toJSON();\n        }\n        return ret;\n    }\n    /**\n     * Create an attachment item and hook up its signals.\n     */\n    _createItem(options) {\n        const factory = this.contentFactory;\n        const item = factory.createAttachmentModel(options);\n        item.changed.connect(this._onGenericChange, this);\n        return item;\n    }\n    /**\n     * Handle a change to the list.\n     */\n    _onMapChanged(sender, args) {\n        if (this._serialized && !this._changeGuard) {\n            this._changeGuard = true;\n            this._serialized.set(this.toJSON());\n            this._changeGuard = false;\n        }\n        this._changed.emit(args);\n        this._stateChanged.emit(void 0);\n    }\n    /**\n     * Handle a change to an item.\n     */\n    _onGenericChange() {\n        this._stateChanged.emit(void 0);\n    }\n}\n/**\n * The namespace for AttachmentsModel class statics.\n */\n(function (AttachmentsModel) {\n    /**\n     * The default implementation of a `IAttachmentsModel.IContentFactory`.\n     */\n    class ContentFactory {\n        /**\n         * Create an attachment model.\n         */\n        createAttachmentModel(options) {\n            return new AttachmentModel(options);\n        }\n    }\n    AttachmentsModel.ContentFactory = ContentFactory;\n    /**\n     * The default attachment model factory.\n     */\n    AttachmentsModel.defaultContentFactory = new ContentFactory();\n})(AttachmentsModel || (AttachmentsModel = {}));\n/**\n * A resolver for cell attachments 'attachment:filename'.\n *\n * Will resolve to a data: url.\n */\nexport class AttachmentsResolver {\n    /**\n     * Create an attachments resolver object.\n     */\n    constructor(options) {\n        this._parent = options.parent || null;\n        this._model = options.model;\n    }\n    /**\n     * Resolve a relative url to a correct server path.\n     */\n    async resolveUrl(url) {\n        if (this._parent && !url.startsWith('attachment:')) {\n            return this._parent.resolveUrl(url);\n        }\n        return url;\n    }\n    /**\n     * Get the download url of a given absolute server path.\n     *\n     * #### Notes\n     * The returned URL may include a query parameter.\n     */\n    async getDownloadUrl(path) {\n        if (this._parent && !path.startsWith('attachment:')) {\n            return this._parent.getDownloadUrl(path);\n        }\n        // Return a data URL with the data of the url\n        const key = path.slice('attachment:'.length);\n        const attachment = this._model.get(key);\n        if (attachment === undefined) {\n            // Resolve with unprocessed path, to show as broken image\n            return path;\n        }\n        const { data } = attachment;\n        const mimeType = Object.keys(data)[0];\n        // Only support known safe types:\n        if (mimeType === undefined ||\n            imageRendererFactory.mimeTypes.indexOf(mimeType) === -1) {\n            throw new Error(`Cannot render unknown image mime type \"${mimeType}\".`);\n        }\n        const dataUrl = `data:${mimeType};base64,${data[mimeType]}`;\n        return dataUrl;\n    }\n    /**\n     * Whether the URL should be handled by the resolver\n     * or not.\n     */\n    isLocal(url) {\n        var _a, _b, _c;\n        if (this._parent && !url.startsWith('attachment:')) {\n            return (_c = (_b = (_a = this._parent).isLocal) === null || _b === void 0 ? void 0 : _b.call(_a, url)) !== null && _c !== void 0 ? _c : true;\n        }\n        return true;\n    }\n}\n//# sourceMappingURL=model.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { Signal } from '@lumino/signaling';\nimport { AttachmentsModel } from '@jupyterlab/attachments';\nimport { CodeEditor } from '@jupyterlab/codeeditor';\nimport { OutputAreaModel } from '@jupyterlab/outputarea';\nimport { createMutex, createStandaloneCell } from '@jupyter/ydoc';\nconst globalModelDBMutex = createMutex();\nexport function isCodeCellModel(model) {\n    return model.type === 'code';\n}\nexport function isMarkdownCellModel(model) {\n    return model.type === 'markdown';\n}\nexport function isRawCellModel(model) {\n    return model.type === 'raw';\n}\n/**\n * An implementation of the cell model.\n */\nexport class CellModel extends CodeEditor.Model {\n    constructor(options = {}) {\n        const { cell_type, sharedModel, ...others } = options;\n        super({\n            sharedModel: sharedModel !== null && sharedModel !== void 0 ? sharedModel : createStandaloneCell({\n                cell_type: cell_type !== null && cell_type !== void 0 ? cell_type : 'raw',\n                id: options.id\n            }),\n            ...others\n        });\n        /**\n         * A signal emitted when the state of the model changes.\n         */\n        this.contentChanged = new Signal(this);\n        /**\n         * A signal emitted when a model state changes.\n         */\n        this.stateChanged = new Signal(this);\n        this._metadataChanged = new Signal(this);\n        this._trusted = false;\n        this.standaloneModel = typeof options.sharedModel === 'undefined';\n        this.trusted = !!this.getMetadata('trusted') || !!options.trusted;\n        this.sharedModel.changed.connect(this.onGenericChange, this);\n        this.sharedModel.metadataChanged.connect(this._onMetadataChanged, this);\n    }\n    /**\n     * Signal emitted when cell metadata changes.\n     */\n    get metadataChanged() {\n        return this._metadataChanged;\n    }\n    /**\n     * The id for the cell.\n     */\n    get id() {\n        return this.sharedModel.getId();\n    }\n    /**\n     * The metadata associated with the cell.\n     */\n    get metadata() {\n        return this.sharedModel.metadata;\n    }\n    /**\n     * The trusted state of the model.\n     */\n    get trusted() {\n        return this._trusted;\n    }\n    set trusted(newValue) {\n        const oldValue = this.trusted;\n        if (oldValue !== newValue) {\n            this._trusted = newValue;\n            this.onTrustedChanged(this, { newValue, oldValue });\n        }\n    }\n    /**\n     * Dispose of the resources held by the model.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this.sharedModel.changed.disconnect(this.onGenericChange, this);\n        this.sharedModel.metadataChanged.disconnect(this._onMetadataChanged, this);\n        super.dispose();\n    }\n    /**\n     * Handle a change to the trusted state.\n     *\n     * The default implementation is a no-op.\n     */\n    onTrustedChanged(trusted, args) {\n        /* no-op */\n    }\n    /**\n     * Delete a metadata\n     *\n     * @param key Metadata key\n     */\n    deleteMetadata(key) {\n        return this.sharedModel.deleteMetadata(key);\n    }\n    /**\n     * Get a metadata\n     *\n     * ### Notes\n     * This returns a copy of the key value.\n     *\n     * @param key Metadata key\n     */\n    getMetadata(key) {\n        return this.sharedModel.getMetadata(key);\n    }\n    /**\n     * Set a metadata\n     *\n     * @param key Metadata key\n     * @param value Metadata value\n     */\n    setMetadata(key, value) {\n        if (typeof value === 'undefined') {\n            this.sharedModel.deleteMetadata(key);\n        }\n        else {\n            this.sharedModel.setMetadata(key, value);\n        }\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return this.sharedModel.toJSON();\n    }\n    /**\n     * Handle a change to the observable value.\n     */\n    onGenericChange() {\n        this.contentChanged.emit(void 0);\n    }\n    _onMetadataChanged(sender, change) {\n        this._metadataChanged.emit(change);\n    }\n}\n/**\n * A base implementation for cell models with attachments.\n */\nexport class AttachmentsCellModel extends CellModel {\n    /**\n     * Construct a new cell with optional attachments.\n     */\n    constructor(options) {\n        var _a;\n        super(options);\n        const factory = (_a = options.contentFactory) !== null && _a !== void 0 ? _a : AttachmentsCellModel.defaultContentFactory;\n        const values = this.sharedModel.getAttachments();\n        this._attachments = factory.createAttachmentsModel({ values });\n        this._attachments.stateChanged.connect(this.onGenericChange, this);\n        this._attachments.changed.connect(this._onAttachmentsChange, this);\n        this.sharedModel.changed.connect(this._onSharedModelChanged, this);\n    }\n    /**\n     * Get the attachments of the model.\n     */\n    get attachments() {\n        return this._attachments;\n    }\n    /**\n     * Dispose of the resources held by the model.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._attachments.stateChanged.disconnect(this.onGenericChange, this);\n        this._attachments.changed.disconnect(this._onAttachmentsChange, this);\n        this._attachments.dispose();\n        this.sharedModel.changed.disconnect(this._onSharedModelChanged, this);\n        super.dispose();\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return super.toJSON();\n    }\n    /**\n     * Handle a change to the cell outputs modelDB and reflect it in the shared model.\n     */\n    _onAttachmentsChange(sender, event) {\n        const cell = this.sharedModel;\n        globalModelDBMutex(() => cell.setAttachments(sender.toJSON()));\n    }\n    /**\n     * Handle a change to the code cell value.\n     */\n    _onSharedModelChanged(slot, change) {\n        if (change.attachmentsChange) {\n            const cell = this.sharedModel;\n            globalModelDBMutex(() => { var _a; return this._attachments.fromJSON((_a = cell.getAttachments()) !== null && _a !== void 0 ? _a : {}); });\n        }\n    }\n}\n/**\n * The namespace for `AttachmentsCellModel` statics.\n */\n(function (AttachmentsCellModel) {\n    /**\n     * The default implementation of an `IContentFactory`.\n     */\n    class ContentFactory {\n        /**\n         * Create an attachments model.\n         */\n        createAttachmentsModel(options) {\n            return new AttachmentsModel(options);\n        }\n    }\n    AttachmentsCellModel.ContentFactory = ContentFactory;\n    /**\n     * The shared `ContentFactory` instance.\n     */\n    AttachmentsCellModel.defaultContentFactory = new ContentFactory();\n})(AttachmentsCellModel || (AttachmentsCellModel = {}));\n/**\n * An implementation of a raw cell model.\n */\nexport class RawCellModel extends AttachmentsCellModel {\n    /**\n     * Construct a raw cell model from optional shared model.\n     */\n    constructor(options = {}) {\n        super({\n            cell_type: 'raw',\n            ...options\n        });\n    }\n    /**\n     * The type of the cell.\n     */\n    get type() {\n        return 'raw';\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return super.toJSON();\n    }\n}\n/**\n * An implementation of a markdown cell model.\n */\nexport class MarkdownCellModel extends AttachmentsCellModel {\n    /**\n     * Construct a markdown cell model from optional shared model.\n     */\n    constructor(options = {}) {\n        super({\n            cell_type: 'markdown',\n            ...options\n        });\n        // Use the Github-flavored markdown mode.\n        this.mimeType = 'text/x-ipythongfm';\n    }\n    /**\n     * The type of the cell.\n     */\n    get type() {\n        return 'markdown';\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return super.toJSON();\n    }\n}\n/**\n * An implementation of a code cell Model.\n */\nexport class CodeCellModel extends CellModel {\n    /**\n     * Construct a new code cell with optional original cell content.\n     */\n    constructor(options = {}) {\n        var _a;\n        super({\n            cell_type: 'code',\n            ...options\n        });\n        this._executedCode = '';\n        this._isDirty = false;\n        const factory = (_a = options === null || options === void 0 ? void 0 : options.contentFactory) !== null && _a !== void 0 ? _a : CodeCellModel.defaultContentFactory;\n        const trusted = this.trusted;\n        const outputs = this.sharedModel.getOutputs();\n        this._outputs = factory.createOutputArea({ trusted, values: outputs });\n        this.sharedModel.changed.connect(this._onSharedModelChanged, this);\n        this._outputs.changed.connect(this.onGenericChange, this);\n        this._outputs.changed.connect(this.onOutputsChange, this);\n    }\n    /**\n     * The type of the cell.\n     */\n    get type() {\n        return 'code';\n    }\n    /**\n     * The execution count of the cell.\n     */\n    get executionCount() {\n        return this.sharedModel.execution_count || null;\n    }\n    set executionCount(newValue) {\n        this.sharedModel.execution_count = newValue || null;\n    }\n    /**\n     * The execution state of the cell.\n     */\n    get executionState() {\n        return this.sharedModel.executionState;\n    }\n    set executionState(newValue) {\n        this.sharedModel.executionState = newValue;\n    }\n    /**\n     * Whether the cell is dirty or not.\n     *\n     * A cell is dirty if it is output is not empty and does not\n     * result of the input code execution.\n     */\n    get isDirty() {\n        // Test could be done dynamically with this._executedCode\n        // but for performance reason, the diff status is stored in a boolean.\n        return this._isDirty;\n    }\n    /**\n     * Public Set whether the cell is dirty or not.\n     */\n    set isDirty(dirty) {\n        this._setDirty(dirty);\n    }\n    /**\n     * The cell outputs.\n     */\n    get outputs() {\n        return this._outputs;\n    }\n    clearExecution() {\n        this.outputs.clear();\n        this.executionCount = null;\n        this.executionState = 'idle';\n        this._setDirty(false);\n        this.sharedModel.deleteMetadata('execution');\n        // We trust this cell as it no longer has any outputs.\n        this.trusted = true;\n    }\n    /**\n     * Dispose of the resources held by the model.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this.sharedModel.changed.disconnect(this._onSharedModelChanged, this);\n        this._outputs.changed.disconnect(this.onGenericChange, this);\n        this._outputs.changed.disconnect(this.onOutputsChange, this);\n        this._outputs.dispose();\n        this._outputs = null;\n        super.dispose();\n    }\n    /**\n     * Handle a change to the trusted state.\n     */\n    onTrustedChanged(trusted, args) {\n        const newTrusted = args.newValue;\n        if (this._outputs) {\n            this._outputs.trusted = newTrusted;\n        }\n        if (newTrusted) {\n            const codeCell = this.sharedModel;\n            const metadata = codeCell.getMetadata();\n            metadata.trusted = true;\n            codeCell.setMetadata(metadata);\n        }\n        this.stateChanged.emit({\n            name: 'trusted',\n            oldValue: args.oldValue,\n            newValue: newTrusted\n        });\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return super.toJSON();\n    }\n    /**\n     * Handle a change to the cell outputs modelDB and reflect it in the shared model.\n     */\n    onOutputsChange(sender, event) {\n        const codeCell = this.sharedModel;\n        globalModelDBMutex(() => {\n            switch (event.type) {\n                case 'add': {\n                    for (const output of event.newValues) {\n                        if (output.type === 'stream') {\n                            output.streamText.changed.connect((sender, textEvent) => {\n                                if (textEvent.options !== undefined &&\n                                    textEvent.options['silent']) {\n                                    return;\n                                }\n                                const codeCell = this.sharedModel;\n                                if (textEvent.type === 'remove') {\n                                    codeCell.removeStreamOutput(event.newIndex, textEvent.start, 'silent-change');\n                                }\n                                else {\n                                    codeCell.appendStreamOutput(event.newIndex, textEvent.value, 'silent-change');\n                                }\n                            }, this);\n                        }\n                    }\n                    const outputs = event.newValues.map(output => output.toJSON());\n                    codeCell.updateOutputs(event.newIndex, event.newIndex, outputs, 'silent-change');\n                    break;\n                }\n                case 'set': {\n                    const newValues = event.newValues.map(output => output.toJSON());\n                    codeCell.updateOutputs(event.oldIndex, event.oldIndex + newValues.length, newValues, 'silent-change');\n                    break;\n                }\n                case 'remove':\n                    codeCell.updateOutputs(event.oldIndex, event.oldValues.length, [], 'silent-change');\n                    break;\n                default:\n                    throw new Error(`Invalid event type: ${event.type}`);\n            }\n        });\n    }\n    /**\n     * Handle a change to the code cell value.\n     */\n    _onSharedModelChanged(slot, change) {\n        if (change.streamOutputChange) {\n            globalModelDBMutex(() => {\n                for (const streamOutputChange of change.streamOutputChange) {\n                    if ('delete' in streamOutputChange) {\n                        this._outputs.removeStreamOutput(streamOutputChange.delete);\n                    }\n                    if ('insert' in streamOutputChange) {\n                        this._outputs.appendStreamOutput(streamOutputChange.insert.toString());\n                    }\n                }\n            });\n        }\n        if (change.outputsChange) {\n            globalModelDBMutex(() => {\n                let retain = 0;\n                for (const outputsChange of change.outputsChange) {\n                    if ('retain' in outputsChange) {\n                        retain += outputsChange.retain;\n                    }\n                    if ('delete' in outputsChange) {\n                        for (let i = 0; i < outputsChange.delete; i++) {\n                            this._outputs.remove(retain);\n                        }\n                    }\n                    if ('insert' in outputsChange) {\n                        // Inserting an output always results in appending it.\n                        for (const output of outputsChange.insert) {\n                            // For compatibility with older ydoc where a plain object,\n                            // (rather than a Map instance) could be provided.\n                            // In a future major release the use of Map will be required.\n                            this._outputs.add('toJSON' in output ? output.toJSON() : output);\n                        }\n                    }\n                }\n            });\n        }\n        if (change.executionCountChange) {\n            if (change.executionCountChange.newValue &&\n                (this.isDirty || !change.executionCountChange.oldValue)) {\n                this._setDirty(false);\n            }\n            this.stateChanged.emit({\n                name: 'executionCount',\n                oldValue: change.executionCountChange.oldValue,\n                newValue: change.executionCountChange.newValue\n            });\n        }\n        if (change.executionStateChange) {\n            this.stateChanged.emit({\n                name: 'executionState',\n                oldValue: change.executionStateChange.oldValue,\n                newValue: change.executionStateChange.newValue\n            });\n        }\n        if (change.sourceChange && this.executionCount !== null) {\n            this._setDirty(this._executedCode !== this.sharedModel.getSource().trim());\n        }\n    }\n    /**\n     * Set whether the cell is dirty or not.\n     */\n    _setDirty(v) {\n        if (!v) {\n            this._executedCode = this.sharedModel.getSource().trim();\n        }\n        if (v !== this._isDirty) {\n            this._isDirty = v;\n            this.stateChanged.emit({\n                name: 'isDirty',\n                oldValue: !v,\n                newValue: v\n            });\n        }\n    }\n}\n/**\n * The namespace for `CodeCellModel` statics.\n */\n(function (CodeCellModel) {\n    /**\n     * The default implementation of an `IContentFactory`.\n     */\n    class ContentFactory {\n        /**\n         * Create an output area.\n         */\n        createOutputArea(options) {\n            return new OutputAreaModel(options);\n        }\n    }\n    CodeCellModel.ContentFactory = ContentFactory;\n    /**\n     * The shared `ContentFactory` instance.\n     */\n    CodeCellModel.defaultContentFactory = new ContentFactory();\n})(CodeCellModel || (CodeCellModel = {}));\n//# sourceMappingURL=model.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { ellipsesIcon } from '@jupyterlab/ui-components';\nimport { Widget } from '@lumino/widgets';\nimport { nullTranslator } from '@jupyterlab/translation';\n/**\n * The CSS class added to placeholders.\n */\nconst PLACEHOLDER_CLASS = 'jp-Placeholder';\n/**\n * The CSS classes added to input placeholder prompts.\n */\nconst INPUT_PROMPT_CLASS = 'jp-Placeholder-prompt jp-InputPrompt';\n/**\n * The CSS classes added to output placeholder prompts.\n */\nconst OUTPUT_PROMPT_CLASS = 'jp-Placeholder-prompt jp-OutputPrompt';\n/**\n * The CSS class added to placeholder content.\n */\nconst CONTENT_CLASS = 'jp-Placeholder-content';\n/**\n * The CSS class added to input placeholders.\n */\nconst INPUT_PLACEHOLDER_CLASS = 'jp-InputPlaceholder';\n/**\n * The CSS class added to output placeholders.\n */\nconst OUTPUT_PLACEHOLDER_CLASS = 'jp-OutputPlaceholder';\n/**\n * An base class for placeholders\n *\n * ### Notes\n * A placeholder is the element that is shown when input/output\n * is hidden.\n */\nexport class Placeholder extends Widget {\n    /**\n     * Construct a new placeholder.\n     */\n    constructor(options) {\n        var _a, _b, _c;\n        const node = document.createElement('div');\n        super({ node });\n        const trans = ((_a = options.translator) !== null && _a !== void 0 ? _a : nullTranslator).load('jupyterlab');\n        const innerNode = document.createElement('div');\n        innerNode.className = (_b = options.promptClass) !== null && _b !== void 0 ? _b : '';\n        node.insertAdjacentHTML('afterbegin', innerNode.outerHTML);\n        this._cell = document.createElement('div');\n        this._cell.classList.add(CONTENT_CLASS);\n        this._cell.title = trans.__('Click to expand');\n        const container = this._cell.appendChild(document.createElement('div'));\n        container.classList.add('jp-Placeholder-contentContainer');\n        this._textContent = container.appendChild(document.createElement('span'));\n        this._textContent.className = 'jp-PlaceholderText';\n        this._textContent.innerText = (_c = options.text) !== null && _c !== void 0 ? _c : '';\n        node.appendChild(this._cell);\n        ellipsesIcon.element({\n            container: container.appendChild(document.createElement('span')),\n            className: 'jp-MoreHorizIcon',\n            elementPosition: 'center',\n            height: 'auto',\n            width: '32px'\n        });\n        this.addClass(PLACEHOLDER_CLASS);\n        this._callback = options.callback;\n    }\n    /**\n     * The text displayed in the placeholder.\n     */\n    set text(t) {\n        this._textContent.innerText = t;\n    }\n    get text() {\n        return this._textContent.innerText;\n    }\n    onAfterAttach(msg) {\n        super.onAfterAttach(msg);\n        this.node.addEventListener('click', this._callback);\n    }\n    onBeforeDetach(msg) {\n        this.node.removeEventListener('click', this._callback);\n        super.onBeforeDetach(msg);\n    }\n}\n/**\n * The input placeholder class.\n */\nexport class InputPlaceholder extends Placeholder {\n    /**\n     * Construct a new input placeholder.\n     */\n    constructor(options) {\n        super({ ...options, promptClass: INPUT_PROMPT_CLASS });\n        this.addClass(INPUT_PLACEHOLDER_CLASS);\n    }\n}\n/**\n * The output placeholder class.\n */\nexport class OutputPlaceholder extends Placeholder {\n    /**\n     * Construct a new output placeholder.\n     */\n    constructor(options) {\n        super({ ...options, promptClass: OUTPUT_PROMPT_CLASS });\n        this.addClass(OUTPUT_PLACEHOLDER_CLASS);\n    }\n}\n//# sourceMappingURL=placeholder.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { EditorSearchProvider } from '@jupyterlab/codemirror';\nimport { signalToPromise } from '@jupyterlab/coreutils';\nimport { GenericSearchProvider } from '@jupyterlab/documentsearch';\n/**\n * Class applied on highlighted search matches\n */\nexport const SELECTED_HIGHLIGHT_CLASS = 'jp-mod-selected';\n/**\n * Search provider for cells.\n */\nexport class CellSearchProvider extends EditorSearchProvider {\n    constructor(cell) {\n        super();\n        this.cell = cell;\n        if (!this.cell.inViewport && !this.cell.editor) {\n            void signalToPromise(cell.inViewportChanged).then(([, inViewport]) => {\n                if (inViewport) {\n                    this.cmHandler.setEditor(this.editor);\n                }\n            });\n        }\n    }\n    /**\n     * Text editor\n     */\n    get editor() {\n        return this.cell.editor;\n    }\n    /**\n     * Editor content model\n     */\n    get model() {\n        return this.cell.model;\n    }\n}\n/**\n * Code cell search provider\n */\nclass CodeCellSearchProvider extends CellSearchProvider {\n    /**\n     * Constructor\n     *\n     * @param cell Cell widget\n     */\n    constructor(cell) {\n        super(cell);\n        this.currentProviderIndex = -1;\n        this.outputsProvider = [];\n        const outputs = this.cell.outputArea;\n        this._onOutputsChanged(outputs, outputs.widgets.length).catch(reason => {\n            console.error(`Failed to initialize search on cell outputs.`, reason);\n        });\n        outputs.outputLengthChanged.connect(this._onOutputsChanged, this);\n        outputs.disposed.connect(() => {\n            outputs.outputLengthChanged.disconnect(this._onOutputsChanged);\n        }, this);\n    }\n    /**\n     * Number of matches in the cell.\n     */\n    get matchesCount() {\n        if (!this.isActive) {\n            return 0;\n        }\n        return (super.matchesCount +\n            this.outputsProvider.reduce((sum, provider) => { var _a; return sum + ((_a = provider.matchesCount) !== null && _a !== void 0 ? _a : 0); }, 0));\n    }\n    /**\n     * Clear currently highlighted match.\n     */\n    async clearHighlight() {\n        await super.clearHighlight();\n        await Promise.all(this.outputsProvider.map(provider => provider.clearHighlight()));\n    }\n    /**\n     * Dispose the search provider\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        super.dispose();\n        this.outputsProvider.map(provider => {\n            provider.dispose();\n        });\n        this.outputsProvider.length = 0;\n    }\n    /**\n     * Highlight the next match.\n     *\n     * @returns The next match if there is one.\n     */\n    async highlightNext(loop, options) {\n        var _a;\n        // If we're scanning from the previous match, test whether we're\n        // at the end of the matches list.\n        const from = (_a = options === null || options === void 0 ? void 0 : options.from) !== null && _a !== void 0 ? _a : '';\n        if (this.matchesCount === 0 ||\n            (from === 'previous-match' &&\n                this.currentIndex !== null &&\n                this.currentIndex + 1 >= this.cmHandler.matches.length) ||\n            !this.isActive) {\n            this.currentIndex = null;\n        }\n        else {\n            if (this.currentProviderIndex === -1) {\n                const match = await super.highlightNext(loop, options);\n                if (match) {\n                    this.currentIndex = this.cmHandler.currentIndex;\n                    return match;\n                }\n                else {\n                    this.currentProviderIndex = 0;\n                }\n            }\n            while (this.currentProviderIndex < this.outputsProvider.length) {\n                const provider = this.outputsProvider[this.currentProviderIndex];\n                const match = await provider.highlightNext(false);\n                if (match) {\n                    this.currentIndex =\n                        super.matchesCount +\n                            this.outputsProvider\n                                .slice(0, this.currentProviderIndex)\n                                .reduce((sum, provider) => { var _a; return (sum += (_a = provider.matchesCount) !== null && _a !== void 0 ? _a : 0); }, 0) +\n                            provider.currentMatchIndex;\n                    return match;\n                }\n                else {\n                    this.currentProviderIndex += 1;\n                }\n            }\n            this.currentProviderIndex = -1;\n            this.currentIndex = null;\n            return undefined;\n        }\n    }\n    /**\n     * Highlight the previous match.\n     *\n     * @returns The previous match if there is one.\n     */\n    async highlightPrevious() {\n        if (this.matchesCount === 0 || !this.isActive) {\n            this.currentIndex = null;\n        }\n        else {\n            if (this.currentIndex === null) {\n                this.currentProviderIndex = this.outputsProvider.length - 1;\n            }\n            while (this.currentProviderIndex >= 0) {\n                const provider = this.outputsProvider[this.currentProviderIndex];\n                const match = await provider.highlightPrevious(false);\n                if (match) {\n                    this.currentIndex =\n                        super.matchesCount +\n                            this.outputsProvider\n                                .slice(0, this.currentProviderIndex)\n                                .reduce((sum, provider) => { var _a; return (sum += (_a = provider.matchesCount) !== null && _a !== void 0 ? _a : 0); }, 0) +\n                            provider.currentMatchIndex;\n                    return match;\n                }\n                else {\n                    this.currentProviderIndex -= 1;\n                }\n            }\n            const match = await super.highlightPrevious();\n            if (match) {\n                this.currentIndex = this.cmHandler.currentIndex;\n                return match;\n            }\n            else {\n                this.currentIndex = null;\n                return undefined;\n            }\n        }\n    }\n    /**\n     * Initialize the search using the provided options. Should update the UI to highlight\n     * all matches and \"select\" the first match.\n     *\n     * @param query A RegExp to be use to perform the search\n     * @param filters Filter parameters to pass to provider\n     */\n    async startQuery(query, filters) {\n        await super.startQuery(query, filters);\n        // Search outputs\n        if ((filters === null || filters === void 0 ? void 0 : filters.output) !== false && this.isActive) {\n            await Promise.all(this.outputsProvider.map(provider => provider.startQuery(query)));\n        }\n    }\n    async endQuery() {\n        var _a;\n        await super.endQuery();\n        if (((_a = this.filters) === null || _a === void 0 ? void 0 : _a.output) !== false && this.isActive) {\n            await Promise.all(this.outputsProvider.map(provider => provider.endQuery()));\n        }\n    }\n    /**\n     * Replace all matches in the cell source with the provided text\n     *\n     * @param newText The replacement text.\n     * @returns Whether a replace occurred.\n     */\n    async replaceAllMatches(newText, options) {\n        if (this.model.getMetadata('editable') === false)\n            return Promise.resolve(false);\n        const result = await super.replaceAllMatches(newText, options);\n        return result;\n    }\n    /**\n     * Replace the currently selected match with the provided text.\n     * If no match is selected, it won't do anything.\n     *\n     * @param newText The replacement text.\n     * @returns Whether a replace occurred.\n     */\n    async replaceCurrentMatch(newText, loop, options) {\n        if (this.model.getMetadata('editable') === false)\n            return Promise.resolve(false);\n        const result = await super.replaceCurrentMatch(newText, loop, options);\n        return result;\n    }\n    async _onOutputsChanged(outputArea, changes) {\n        var _a;\n        this.outputsProvider.forEach(provider => {\n            provider.dispose();\n        });\n        this.outputsProvider.length = 0;\n        this.currentProviderIndex = -1;\n        this.outputsProvider = this.cell.outputArea.widgets.map(output => new GenericSearchProvider(output));\n        if (this.isActive && this.query && ((_a = this.filters) === null || _a === void 0 ? void 0 : _a.output) !== false) {\n            await Promise.all([\n                this.outputsProvider.map(provider => {\n                    void provider.startQuery(this.query);\n                })\n            ]);\n        }\n        this._stateChanged.emit();\n    }\n}\n/**\n * Markdown cell search provider\n */\nclass MarkdownCellSearchProvider extends CellSearchProvider {\n    /**\n     * Constructor\n     *\n     * @param cell Cell widget\n     */\n    constructor(cell) {\n        super(cell);\n        this._unrenderedByHighlight = false;\n        this.renderedProvider = new GenericSearchProvider(cell.renderer);\n    }\n    /**\n     * Clear currently highlighted match\n     */\n    async clearHighlight() {\n        await super.clearHighlight();\n        await this.renderedProvider.clearHighlight();\n    }\n    /**\n     * Dispose the search provider\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        super.dispose();\n        this.renderedProvider.dispose();\n    }\n    /**\n     * Stop the search and clean any UI elements.\n     */\n    async endQuery() {\n        await super.endQuery();\n        await this.renderedProvider.endQuery();\n    }\n    /**\n     * Highlight the next match.\n     *\n     * @returns The next match if there is one.\n     */\n    async highlightNext(loop = true, options) {\n        let match = undefined;\n        if (!this.isActive) {\n            return match;\n        }\n        const cell = this.cell;\n        if (cell.rendered && this.matchesCount > 0) {\n            // Unrender the cell\n            this._unrenderedByHighlight = true;\n            const waitForRendered = signalToPromise(cell.renderedChanged);\n            cell.rendered = false;\n            await waitForRendered;\n        }\n        match = await super.highlightNext(loop, options);\n        return match;\n    }\n    /**\n     * Highlight the previous match.\n     *\n     * @returns The previous match if there is one.\n     */\n    async highlightPrevious() {\n        let match = undefined;\n        const cell = this.cell;\n        if (cell.rendered && this.matchesCount > 0) {\n            // Unrender the cell if there are matches within the cell\n            this._unrenderedByHighlight = true;\n            const waitForRendered = signalToPromise(cell.renderedChanged);\n            cell.rendered = false;\n            await waitForRendered;\n        }\n        match = await super.highlightPrevious();\n        return match;\n    }\n    /**\n     * Initialize the search using the provided options. Should update the UI\n     * to highlight all matches and \"select\" the first match.\n     *\n     * @param query A RegExp to be use to perform the search\n     * @param filters Filter parameters to pass to provider\n     */\n    async startQuery(query, filters) {\n        await super.startQuery(query, filters);\n        const cell = this.cell;\n        if (cell.rendered) {\n            this.onRenderedChanged(cell, cell.rendered);\n        }\n        cell.renderedChanged.connect(this.onRenderedChanged, this);\n    }\n    /**\n     * Replace all matches in the cell source with the provided text\n     *\n     * @param newText The replacement text.\n     * @returns Whether a replace occurred.\n     */\n    async replaceAllMatches(newText, options) {\n        if (this.model.getMetadata('editable') === false)\n            return Promise.resolve(false);\n        const result = await super.replaceAllMatches(newText, options);\n        // if the cell is rendered force update\n        if (this.cell.rendered) {\n            this.cell.update();\n        }\n        return result;\n    }\n    /**\n     * Replace the currently selected match with the provided text.\n     * If no match is selected, it won't do anything.\n     *\n     * @param newText The replacement text.\n     * @returns Whether a replace occurred.\n     */\n    async replaceCurrentMatch(newText, loop, options) {\n        if (this.model.getMetadata('editable') === false)\n            return Promise.resolve(false);\n        const result = await super.replaceCurrentMatch(newText, loop, options);\n        return result;\n    }\n    /**\n     * Callback on rendered state change\n     *\n     * @param cell Cell that emitted the change\n     * @param rendered New rendered value\n     */\n    onRenderedChanged(cell, rendered) {\n        var _a;\n        if (!this._unrenderedByHighlight) {\n            this.currentIndex = null;\n        }\n        this._unrenderedByHighlight = false;\n        if (this.isActive) {\n            if (rendered) {\n                void this.renderedProvider.startQuery(this.query);\n            }\n            else {\n                // Force cursor position to ensure reverse search is working as expected\n                (_a = cell.editor) === null || _a === void 0 ? void 0 : _a.setCursorPosition({ column: 0, line: 0 });\n                void this.renderedProvider.endQuery();\n            }\n        }\n    }\n}\n/**\n * Factory to create a cell search provider\n *\n * @param cell Cell widget\n * @returns Cell search provider\n */\nexport function createCellSearchProvider(cell) {\n    if (cell.isPlaceholder()) {\n        return new CellSearchProvider(cell);\n    }\n    switch (cell.model.type) {\n        case 'code':\n            return new CodeCellSearchProvider(cell);\n        case 'markdown':\n            return new MarkdownCellSearchProvider(cell);\n        default:\n            return new CellSearchProvider(cell);\n    }\n}\n//# sourceMappingURL=searchprovider.js.map","/*\n * Copyright (c) Jupyter Development Team.\n * Distributed under the terms of the Modified BSD License.\n */\nimport { Throttler } from '@lumino/polling';\nimport { Widget } from '@lumino/widgets';\nimport { Signal } from '@lumino/signaling';\nconst RESIZE_HANDLE_CLASS = 'jp-CellResizeHandle';\nconst CELL_RESIZED_CLASS = 'jp-mod-resizedCell';\n/**\n * A handle that allows to change input/output proportions in side-by-side mode.\n */\nexport class ResizeHandle extends Widget {\n    constructor(targetNode) {\n        super();\n        this.targetNode = targetNode;\n        this._isActive = false;\n        this._isDragging = false;\n        /**\n         * A public signal used to indicate the size of the cell and output has changed.\n         */\n        this.sizeChanged = new Signal(this);\n        this.addClass(RESIZE_HANDLE_CLASS);\n        this._resizer = new Throttler(event => this._resize(event), 50);\n    }\n    /**\n     * Dispose the resizer handle.\n     */\n    dispose() {\n        this._resizer.dispose();\n        super.dispose();\n    }\n    /**\n     * Handle the DOM events for the widget.\n     *\n     * @param event - The DOM event sent to the widget.\n     *\n     */\n    handleEvent(event) {\n        var _a, _b;\n        switch (event.type) {\n            case 'dblclick':\n                (_a = this.targetNode.parentNode) === null || _a === void 0 ? void 0 : _a.childNodes.forEach(node => {\n                    node.classList.remove(CELL_RESIZED_CLASS);\n                });\n                document.documentElement.style.setProperty('--jp-side-by-side-output-size', `1fr`);\n                this._isActive = false;\n                break;\n            case 'mousedown':\n                this._isDragging = true;\n                if (!this._isActive) {\n                    (_b = this.targetNode.parentNode) === null || _b === void 0 ? void 0 : _b.childNodes.forEach(node => {\n                        node.classList.add(CELL_RESIZED_CLASS);\n                    });\n                    this._isActive = true;\n                }\n                window.addEventListener('mousemove', this);\n                window.addEventListener('mouseup', this);\n                break;\n            case 'mousemove': {\n                if (this._isActive && this._isDragging) {\n                    void this._resizer.invoke(event);\n                }\n                break;\n            }\n            case 'mouseup':\n                this._isDragging = false;\n                window.removeEventListener('mousemove', this);\n                window.removeEventListener('mouseup', this);\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Handle `after-attach` messages.\n     */\n    onAfterAttach(msg) {\n        this.node.addEventListener('dblclick', this);\n        this.node.addEventListener('mousedown', this);\n        super.onAfterAttach(msg);\n    }\n    /**\n     * Handle `before-detach` messages.\n     */\n    onBeforeDetach(msg) {\n        this.node.removeEventListener('dblclick', this);\n        this.node.removeEventListener('mousedown', this);\n        super.onBeforeDetach(msg);\n    }\n    _resize(event) {\n        // Gate the output size ratio between {0.05, 50} as sensible defaults.\n        const { width, x } = this.targetNode.getBoundingClientRect();\n        const position = event.clientX - x;\n        const ratio = width / position - 1;\n        if (0 < ratio) {\n            const normalized = Math.max(Math.min(Math.abs(ratio), 50), 0.05);\n            document.documentElement.style.setProperty('--jp-side-by-side-output-size', `${normalized}fr`);\n            this.sizeChanged.emit(normalized);\n        }\n    }\n}\n//# sourceMappingURL=resizeHandle.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { EditorView } from '@codemirror/view';\nimport { ElementExt } from '@lumino/domutils';\nimport { AttachmentsResolver } from '@jupyterlab/attachments';\nimport { DOMUtils } from '@jupyterlab/apputils';\nimport { ActivityMonitor, URLExt } from '@jupyterlab/coreutils';\nimport { OutputArea, OutputPrompt, SimplifiedOutputArea, Stdin } from '@jupyterlab/outputarea';\nimport { imageRendererFactory, MimeModel } from '@jupyterlab/rendermime';\nimport { TableOfContentsUtils } from '@jupyterlab/toc';\nimport { nullTranslator } from '@jupyterlab/translation';\nimport { addIcon, collapseIcon, expandIcon } from '@jupyterlab/ui-components';\nimport { PromiseDelegate, UUID } from '@lumino/coreutils';\nimport { some } from '@lumino/algorithm';\nimport { MessageLoop } from '@lumino/messaging';\nimport { Debouncer } from '@lumino/polling';\nimport { Signal } from '@lumino/signaling';\nimport { Panel, PanelLayout, Widget } from '@lumino/widgets';\nimport { InputCollapser, OutputCollapser } from './collapser';\nimport { CellFooter, CellHeader } from './headerfooter';\nimport { InputArea, InputPrompt } from './inputarea';\nimport { InputPlaceholder, OutputPlaceholder } from './placeholder';\nimport { ResizeHandle } from './resizeHandle';\n/**\n * The CSS class added to cell widgets.\n */\nconst CELL_CLASS = 'jp-Cell';\n/**\n * The CSS class added to the cell header.\n */\nconst CELL_HEADER_CLASS = 'jp-Cell-header';\n/**\n * The CSS class added to the cell footer.\n */\nconst CELL_FOOTER_CLASS = 'jp-Cell-footer';\n/**\n * The CSS class added to the cell input wrapper.\n */\nconst CELL_INPUT_WRAPPER_CLASS = 'jp-Cell-inputWrapper';\n/**\n * The CSS class added to the cell output wrapper.\n */\nconst CELL_OUTPUT_WRAPPER_CLASS = 'jp-Cell-outputWrapper';\n/**\n * The CSS class added to the cell input area.\n */\nconst CELL_INPUT_AREA_CLASS = 'jp-Cell-inputArea';\n/**\n * The CSS class added to the cell output area.\n */\nconst CELL_OUTPUT_AREA_CLASS = 'jp-Cell-outputArea';\n/**\n * The CSS class added to the cell input collapser.\n */\nconst CELL_INPUT_COLLAPSER_CLASS = 'jp-Cell-inputCollapser';\n/**\n * The CSS class added to the cell output collapser.\n */\nconst CELL_OUTPUT_COLLAPSER_CLASS = 'jp-Cell-outputCollapser';\n/**\n * The class name added to the cell when dirty.\n */\nconst DIRTY_CLASS = 'jp-mod-dirty';\n/**\n * The class name added to code cells.\n */\nconst CODE_CELL_CLASS = 'jp-CodeCell';\n/**\n * The class name added to markdown cells.\n */\nconst MARKDOWN_CELL_CLASS = 'jp-MarkdownCell';\n/**\n * The class name added to rendered markdown output widgets.\n */\nconst MARKDOWN_OUTPUT_CLASS = 'jp-MarkdownOutput';\nconst MARKDOWN_HEADING_COLLAPSED = 'jp-MarkdownHeadingCollapsed';\nconst HEADING_COLLAPSER_CLASS = 'jp-collapseHeadingButton';\nconst SHOW_HIDDEN_CELLS_CLASS = 'jp-showHiddenCellsButton';\n/**\n * The class name added to raw cells.\n */\nconst RAW_CELL_CLASS = 'jp-RawCell';\n/**\n * The class name added to a rendered input area.\n */\nconst RENDERED_CLASS = 'jp-mod-rendered';\nconst NO_OUTPUTS_CLASS = 'jp-mod-noOutputs';\n/**\n * The text applied to an empty markdown cell.\n */\nconst DEFAULT_MARKDOWN_TEXT = 'Type Markdown and LaTeX: $ α^2 $';\n/**\n * The timeout to wait for change activity to have ceased before rendering.\n */\nconst RENDER_TIMEOUT = 1000;\n/**\n * The mime type for a rich contents drag object.\n */\nconst CONTENTS_MIME_RICH = 'application/x-jupyter-icontentsrich';\n/** ****************************************************************************\n * Cell\n ******************************************************************************/\n/**\n * A base cell widget.\n */\nexport class Cell extends Widget {\n    /**\n     * Construct a new base cell widget.\n     */\n    constructor(options) {\n        var _a, _b, _c, _d;\n        super();\n        this.prompt = '';\n        this._displayChanged = new Signal(this);\n        this._scrollRequested = new Signal(this);\n        /**\n         * Editor extension emitting `scrollRequested` signal on scroll.\n         *\n         * Scrolling within editor will be prevented when a cell is out out viewport.\n         * Windowed containers including cells should listen to the scroll request\n         * signal and invoke the `scrollWithinCell()` callback after scrolling the cell\n         * back into the view (and after updating the `inViewport` property).\n         */\n        this._scrollHandlerExtension = EditorView.scrollHandler.of((view, range, options) => {\n            // When cell is in the viewport we can scroll within the editor immediately.\n            // When cell is out of viewport, the windowed container needs to first\n            // scroll the cell into the viewport (otherwise CodeMirror is unable to\n            // calculate the correct scroll delta) before invoking scrolling in editor.\n            const inWindowedContainer = this._inViewport !== null;\n            const preventDefault = inWindowedContainer && !this._inViewport;\n            this._scrollRequested.emit({\n                defaultPrevented: preventDefault,\n                scrollWithinCell: () => {\n                    view.dispatch({\n                        effects: EditorView.scrollIntoView(range, options)\n                    });\n                }\n            });\n            return preventDefault;\n        });\n        this._editorConfig = {};\n        this._editorExtensions = [];\n        this._inputHidden = false;\n        this._inViewportChanged = new Signal(this);\n        this._readOnly = false;\n        this._ready = new PromiseDelegate();\n        this._resizeDebouncer = new Debouncer(() => {\n            this._displayChanged.emit();\n        }, 0);\n        this._syncCollapse = false;\n        this._syncEditable = false;\n        this.addClass(CELL_CLASS);\n        const model = (this._model = options.model);\n        this.contentFactory = options.contentFactory;\n        this.layout = (_a = options.layout) !== null && _a !== void 0 ? _a : new PanelLayout();\n        // Set up translator for aria labels\n        this.translator = (_b = options.translator) !== null && _b !== void 0 ? _b : nullTranslator;\n        // For cells disable searching with CodeMirror search panel.\n        this._editorConfig = { searchWithCM: false, ...options.editorConfig };\n        this._editorExtensions = (_c = options.editorExtensions) !== null && _c !== void 0 ? _c : [];\n        this._editorExtensions.push(this._scrollHandlerExtension);\n        this._placeholder = true;\n        this._inViewport = null;\n        this.placeholder = (_d = options.placeholder) !== null && _d !== void 0 ? _d : true;\n        model.metadataChanged.connect(this.onMetadataChanged, this);\n    }\n    /**\n     * Initialize view state from model.\n     *\n     * #### Notes\n     * Should be called after construction. For convenience, returns this, so it\n     * can be chained in the construction, like `new Foo().initializeState();`\n     */\n    initializeState() {\n        this.loadCollapseState();\n        this.loadEditableState();\n        return this;\n    }\n    /**\n     * Signal to indicate that widget has changed visibly (in size, in type, etc)\n     */\n    get displayChanged() {\n        return this._displayChanged;\n    }\n    /**\n     * Whether the cell is in viewport or not.\n     *\n     * #### Notes\n     * This property is managed by the windowed container which holds the cell.\n     * When a cell is not in a windowed container, it always returns `false`,\n     * but this may change in the future major version.\n     */\n    get inViewport() {\n        var _a;\n        return (_a = this._inViewport) !== null && _a !== void 0 ? _a : false;\n    }\n    set inViewport(v) {\n        if (this._inViewport !== v) {\n            this._inViewport = v;\n            this._inViewportChanged.emit(this._inViewport);\n        }\n    }\n    /**\n     * Will emit true just after the node is attached to the DOM\n     * Will emit false just before the node is detached of the DOM\n     */\n    get inViewportChanged() {\n        return this._inViewportChanged;\n    }\n    /**\n     * Whether the cell is a placeholder not yet fully rendered or not.\n     */\n    get placeholder() {\n        return this._placeholder;\n    }\n    set placeholder(v) {\n        if (this._placeholder !== v && v === false) {\n            this.initializeDOM();\n            this._placeholder = v;\n            this._ready.resolve();\n        }\n    }\n    /**\n     * Get the prompt node used by the cell.\n     */\n    get promptNode() {\n        if (this.placeholder) {\n            return null;\n        }\n        if (!this._inputHidden) {\n            return this._input.promptNode;\n        }\n        else {\n            return this._inputPlaceholder.node\n                .firstElementChild;\n        }\n    }\n    /**\n     * Get the CodeEditorWrapper used by the cell.\n     */\n    get editorWidget() {\n        var _a, _b;\n        return (_b = (_a = this._input) === null || _a === void 0 ? void 0 : _a.editorWidget) !== null && _b !== void 0 ? _b : null;\n    }\n    /**\n     * Get the CodeEditor used by the cell.\n     */\n    get editor() {\n        var _a, _b;\n        return (_b = (_a = this._input) === null || _a === void 0 ? void 0 : _a.editor) !== null && _b !== void 0 ? _b : null;\n    }\n    /**\n     * Editor configuration\n     */\n    get editorConfig() {\n        return this._editorConfig;\n    }\n    /**\n     * Cell headings\n     */\n    get headings() {\n        return new Array();\n    }\n    /**\n     * Get the model used by the cell.\n     */\n    get model() {\n        return this._model;\n    }\n    /**\n     * Get the input area for the cell.\n     */\n    get inputArea() {\n        return this._input;\n    }\n    /**\n     * The read only state of the cell.\n     */\n    get readOnly() {\n        return this._readOnly;\n    }\n    set readOnly(value) {\n        if (value === this._readOnly) {\n            return;\n        }\n        this._readOnly = value;\n        if (this.syncEditable) {\n            this.saveEditableState();\n        }\n        this.update();\n    }\n    /**\n     * Whether the cell is a placeholder that defer rendering\n     *\n     * #### Notes\n     * You can wait for the promise `Cell.ready` to wait for the\n     * cell to be rendered.\n     */\n    isPlaceholder() {\n        return this.placeholder;\n    }\n    /**\n     * Save view editable state to model\n     */\n    saveEditableState() {\n        const { sharedModel } = this.model;\n        const current = sharedModel.getMetadata('editable');\n        if ((this.readOnly && current === false) ||\n            (!this.readOnly && current === undefined)) {\n            return;\n        }\n        if (this.readOnly) {\n            sharedModel.setMetadata('editable', false);\n        }\n        else {\n            sharedModel.deleteMetadata('editable');\n        }\n    }\n    /**\n     * Load view editable state from model.\n     */\n    loadEditableState() {\n        this.readOnly =\n            this.model.sharedModel.getMetadata('editable') ===\n                false;\n    }\n    /**\n     * A promise that resolves when the widget renders for the first time.\n     */\n    get ready() {\n        return this._ready.promise;\n    }\n    /**\n     * Set the prompt for the widget.\n     * @deprecated - set the `executionState` on the model instead.\n     */\n    setPrompt(value) {\n        return this._setPrompt(value);\n    }\n    /**\n     * Set the prompt for the widget.\n     *\n     * Note: this method is protected because it is needed in the CodeCell subclass,\n     * but it cannot be defined there because input is private to Cell class.\n     */\n    _setPrompt(value) {\n        var _a;\n        this.prompt = value;\n        (_a = this._input) === null || _a === void 0 ? void 0 : _a.setPrompt(value);\n    }\n    /**\n     * The view state of input being hidden.\n     */\n    get inputHidden() {\n        return this._inputHidden;\n    }\n    set inputHidden(value) {\n        var _a;\n        if (this._inputHidden === value) {\n            return;\n        }\n        if (!this.placeholder) {\n            const layout = this._inputWrapper.layout;\n            if (value) {\n                this._input.parent = null;\n                if (this._inputPlaceholder) {\n                    this._inputPlaceholder.text = (_a = this.model.sharedModel\n                        .getSource()\n                        .split('\\n')) === null || _a === void 0 ? void 0 : _a[0];\n                }\n                layout.addWidget(this._inputPlaceholder);\n            }\n            else {\n                this._inputPlaceholder.parent = null;\n                layout.addWidget(this._input);\n            }\n        }\n        this._inputHidden = value;\n        if (this.syncCollapse) {\n            this.saveCollapseState();\n        }\n        this.handleInputHidden(value);\n    }\n    /**\n     * Save view collapse state to model\n     */\n    saveCollapseState() {\n        const jupyter = { ...this.model.getMetadata('jupyter') };\n        if ((this.inputHidden && jupyter.source_hidden === true) ||\n            (!this.inputHidden && jupyter.source_hidden === undefined)) {\n            return;\n        }\n        if (this.inputHidden) {\n            jupyter.source_hidden = true;\n        }\n        else {\n            delete jupyter.source_hidden;\n        }\n        if (Object.keys(jupyter).length === 0) {\n            this.model.deleteMetadata('jupyter');\n        }\n        else {\n            this.model.setMetadata('jupyter', jupyter);\n        }\n    }\n    /**\n     * Revert view collapse state from model.\n     */\n    loadCollapseState() {\n        var _a;\n        const jupyter = (_a = this.model.getMetadata('jupyter')) !== null && _a !== void 0 ? _a : {};\n        this.inputHidden = !!jupyter.source_hidden;\n    }\n    /**\n     * Handle the input being hidden.\n     *\n     * #### Notes\n     * This is called by the `inputHidden` setter so that subclasses\n     * can perform actions upon the input being hidden without accessing\n     * private state.\n     */\n    handleInputHidden(value) {\n        return;\n    }\n    /**\n     * Whether to sync the collapse state to the cell model.\n     */\n    get syncCollapse() {\n        return this._syncCollapse;\n    }\n    set syncCollapse(value) {\n        if (this._syncCollapse === value) {\n            return;\n        }\n        this._syncCollapse = value;\n        if (value) {\n            this.loadCollapseState();\n        }\n    }\n    /**\n     * Whether to sync the editable state to the cell model.\n     */\n    get syncEditable() {\n        return this._syncEditable;\n    }\n    set syncEditable(value) {\n        if (this._syncEditable === value) {\n            return;\n        }\n        this._syncEditable = value;\n        if (value) {\n            this.loadEditableState();\n        }\n    }\n    /**\n     * Clone the cell, using the same model.\n     */\n    clone() {\n        const constructor = this.constructor;\n        return new constructor({\n            model: this.model,\n            contentFactory: this.contentFactory,\n            placeholder: false,\n            translator: this.translator\n        });\n    }\n    /**\n     * Dispose of the resources held by the widget.\n     */\n    dispose() {\n        // Do nothing if already disposed.\n        if (this.isDisposed) {\n            return;\n        }\n        this._resizeDebouncer.dispose();\n        this._input = null;\n        this._model = null;\n        this._inputWrapper = null;\n        this._inputPlaceholder = null;\n        super.dispose();\n    }\n    /**\n     * Update the editor configuration with the partial provided dictionary.\n     *\n     * @param v Partial editor configuration\n     */\n    updateEditorConfig(v) {\n        this._editorConfig = { ...this._editorConfig, ...v };\n        if (this.editor) {\n            this.editor.setOptions(this._editorConfig);\n        }\n    }\n    /**\n     * Signal emitted when cell requests scrolling to its element.\n     */\n    get scrollRequested() {\n        return this._scrollRequested;\n    }\n    /**\n     * Create children widgets.\n     */\n    initializeDOM() {\n        if (!this.placeholder) {\n            return;\n        }\n        const contentFactory = this.contentFactory;\n        const model = this._model;\n        // Header\n        const header = contentFactory.createCellHeader();\n        header.addClass(CELL_HEADER_CLASS);\n        this.layout.addWidget(header);\n        // Input\n        const inputWrapper = (this._inputWrapper = new Panel());\n        inputWrapper.addClass(CELL_INPUT_WRAPPER_CLASS);\n        const inputCollapser = new InputCollapser();\n        inputCollapser.addClass(CELL_INPUT_COLLAPSER_CLASS);\n        const input = (this._input = new InputArea({\n            model,\n            contentFactory,\n            editorOptions: this.getEditorOptions()\n        }));\n        input.addClass(CELL_INPUT_AREA_CLASS);\n        inputWrapper.addWidget(inputCollapser);\n        inputWrapper.addWidget(input);\n        this.layout.addWidget(inputWrapper);\n        this._inputPlaceholder = new InputPlaceholder({\n            callback: () => {\n                this.inputHidden = !this.inputHidden;\n            },\n            text: input.model.sharedModel.getSource().split('\\n')[0],\n            translator: this.translator\n        });\n        input.model.contentChanged.connect((sender, args) => {\n            var _a;\n            if (this._inputPlaceholder && this.inputHidden) {\n                this._inputPlaceholder.text = (_a = sender.sharedModel\n                    .getSource()\n                    .split('\\n')) === null || _a === void 0 ? void 0 : _a[0];\n            }\n        });\n        if (this.inputHidden) {\n            input.parent = null;\n            inputWrapper.layout.addWidget(this._inputPlaceholder);\n        }\n        // Footer\n        const footer = this.contentFactory.createCellFooter();\n        footer.addClass(CELL_FOOTER_CLASS);\n        this.layout.addWidget(footer);\n    }\n    /**\n     * Get the editor options at initialization.\n     *\n     * @returns Editor options\n     */\n    getEditorOptions() {\n        return { config: this.editorConfig, extensions: this._editorExtensions };\n    }\n    /**\n     * Handle `before-attach` messages.\n     */\n    onBeforeAttach(msg) {\n        if (this.placeholder) {\n            this.placeholder = false;\n        }\n    }\n    /**\n     * Handle `after-attach` messages.\n     */\n    onAfterAttach(msg) {\n        this.update();\n    }\n    /**\n     * Handle `'activate-request'` messages.\n     */\n    onActivateRequest(msg) {\n        var _a;\n        (_a = this.editor) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    /**\n     * Handle `resize` messages.\n     */\n    onResize(msg) {\n        void this._resizeDebouncer.invoke();\n    }\n    /**\n     * Handle `update-request` messages.\n     */\n    onUpdateRequest(msg) {\n        var _a, _b;\n        if (!this._model) {\n            return;\n        }\n        // Handle read only state.\n        if (((_a = this.editor) === null || _a === void 0 ? void 0 : _a.getOption('readOnly')) !== this._readOnly) {\n            (_b = this.editor) === null || _b === void 0 ? void 0 : _b.setOption('readOnly', this._readOnly);\n        }\n    }\n    onContentChanged() {\n        var _a;\n        if (this.inputHidden && this._inputPlaceholder) {\n            this._inputPlaceholder.text = (_a = this.model.sharedModel\n                .getSource()\n                .split('\\n')) === null || _a === void 0 ? void 0 : _a[0];\n        }\n    }\n    /**\n     * Handle changes in the metadata.\n     */\n    onMetadataChanged(model, args) {\n        switch (args.key) {\n            case 'jupyter':\n                if (this.syncCollapse) {\n                    this.loadCollapseState();\n                }\n                break;\n            case 'editable':\n                if (this.syncEditable) {\n                    this.loadEditableState();\n                }\n                break;\n            default:\n                break;\n        }\n    }\n}\n/**\n * The namespace for the `Cell` class statics.\n */\n(function (Cell) {\n    /**\n     * Type of headings\n     */\n    let HeadingType;\n    (function (HeadingType) {\n        /**\n         * Heading from HTML output\n         */\n        HeadingType[HeadingType[\"HTML\"] = 0] = \"HTML\";\n        /**\n         * Heading from Markdown cell or Markdown output\n         */\n        HeadingType[HeadingType[\"Markdown\"] = 1] = \"Markdown\";\n    })(HeadingType = Cell.HeadingType || (Cell.HeadingType = {}));\n    /**\n     * The default implementation of an `IContentFactory`.\n     *\n     * This includes a CodeMirror editor factory to make it easy to use out of the box.\n     */\n    class ContentFactory {\n        /**\n         * Create a content factory for a cell.\n         */\n        constructor(options) {\n            this._editorFactory = options.editorFactory;\n        }\n        /**\n         * The readonly editor factory that create code editors\n         */\n        get editorFactory() {\n            return this._editorFactory;\n        }\n        /**\n         * Create a new cell header for the parent widget.\n         */\n        createCellHeader() {\n            return new CellHeader();\n        }\n        /**\n         * Create a new cell footer for the parent widget.\n         */\n        createCellFooter() {\n            return new CellFooter();\n        }\n        /**\n         * Create an input prompt.\n         */\n        createInputPrompt() {\n            return new InputPrompt();\n        }\n        /**\n         * Create the output prompt for the widget.\n         */\n        createOutputPrompt() {\n            return new OutputPrompt();\n        }\n        /**\n         * Create an stdin widget.\n         */\n        createStdin(options) {\n            return new Stdin(options);\n        }\n    }\n    Cell.ContentFactory = ContentFactory;\n})(Cell || (Cell = {}));\n/** ****************************************************************************\n * CodeCell\n ******************************************************************************/\n/**\n * Code cell layout\n *\n * It will not detached the output area when the cell is detached.\n */\nexport class CodeCellLayout extends PanelLayout {\n    /**\n     * A message handler invoked on a `'before-attach'` message.\n     *\n     * #### Notes\n     * The default implementation of this method forwards the message\n     * to all widgets. It assumes all widget nodes are attached to the\n     * parent widget node.\n     *\n     * This may be reimplemented by subclasses as needed.\n     */\n    onBeforeAttach(msg) {\n        let beforeOutputArea = true;\n        const outputAreaWrapper = this.parent.node.firstElementChild;\n        for (const widget of this) {\n            if (outputAreaWrapper) {\n                if (widget.node === outputAreaWrapper) {\n                    beforeOutputArea = false;\n                }\n                else {\n                    MessageLoop.sendMessage(widget, msg);\n                    if (beforeOutputArea) {\n                        this.parent.node.insertBefore(widget.node, outputAreaWrapper);\n                    }\n                    else {\n                        this.parent.node.appendChild(widget.node);\n                    }\n                    // Force setting isVisible to true as it requires the parent widget to be\n                    // visible. But that flag will be set only during the `onAfterAttach` call.\n                    if (!this.parent.isHidden) {\n                        widget.setFlag(Widget.Flag.IsVisible);\n                    }\n                    // Not called in NotebookWindowedLayout to avoid outputArea\n                    // widgets unwanted update or reset.\n                    MessageLoop.sendMessage(widget, Widget.Msg.AfterAttach);\n                }\n            }\n        }\n    }\n    /**\n     * A message handler invoked on an `'after-detach'` message.\n     *\n     * #### Notes\n     * The default implementation of this method forwards the message\n     * to all widgets. It assumes all widget nodes are attached to the\n     * parent widget node.\n     *\n     * This may be reimplemented by subclasses as needed.\n     */\n    onAfterDetach(msg) {\n        for (const widget of this) {\n            // TODO we could improve this further by removing outputs based\n            // on their mime type (for example plain/text or markdown could safely be detached)\n            // If the cell is out of the view port, its children are already detached -> skip detaching\n            if (!widget.hasClass(CELL_OUTPUT_WRAPPER_CLASS) &&\n                widget.node.isConnected) {\n                // Not called in NotebookWindowedLayout for windowed notebook\n                MessageLoop.sendMessage(widget, Widget.Msg.BeforeDetach);\n                this.parent.node.removeChild(widget.node);\n                MessageLoop.sendMessage(widget, msg);\n            }\n        }\n    }\n}\n/**\n * A widget for a code cell.\n */\nexport class CodeCell extends Cell {\n    /**\n     * Construct a code cell widget.\n     */\n    constructor(options) {\n        var _a;\n        super({ layout: new CodeCellLayout(), ...options, placeholder: true });\n        /**\n         * Detect the movement of the caret in the output area.\n         *\n         * Emits scroll request if the caret moved.\n         */\n        this._detectCaretMovementInOuput = (e) => {\n            const inWindowedContainer = this._inViewport !== null;\n            const defaultPrevented = inWindowedContainer && !this._inViewport;\n            // Because we do not want to scroll on any key, but only on keys which\n            // move the caret (this on keys which cause input and on keys like left,\n            // right, top, bottom arrow, home, end, page down/up - but only if the\n            // cursor is not at the respective end of the input) we need to listen\n            // to the `selectionchange` event on target inputs/textareas, etc.\n            const target = e.target;\n            if (!target || !(target instanceof HTMLElement)) {\n                return;\n            }\n            // Make sure the previous listener gets disconnected\n            if (this._lastTarget) {\n                this._lastTarget.removeEventListener('selectionchange', this._lastOnCaretMovedHandler);\n                document.removeEventListener('selectionchange', this._lastOnCaretMovedHandler);\n            }\n            const onCaretMoved = () => {\n                this._scrollRequested.emit({\n                    scrollWithinCell: ({ scroller }) => {\n                        ElementExt.scrollIntoViewIfNeeded(scroller, target);\n                    },\n                    defaultPrevented\n                });\n            };\n            // Remember the most recent target/handler to disconnect them next time.\n            this._lastTarget = target;\n            this._lastOnCaretMovedHandler = onCaretMoved;\n            // Firefox only supports `selectionchange` on the actual input element,\n            // all other browsers only support it on the top-level document.\n            target.addEventListener('selectionchange', onCaretMoved, { once: true });\n            document.addEventListener('selectionchange', onCaretMoved, {\n                once: true\n            });\n            // Schedule removal of the listener.\n            setTimeout(() => {\n                target.removeEventListener('selectionchange', onCaretMoved);\n                document.removeEventListener('selectionchange', onCaretMoved);\n            }, 250);\n        };\n        this._headingsCache = null;\n        this._outputHidden = false;\n        this._outputWrapper = null;\n        this._outputPlaceholder = null;\n        this._syncScrolled = false;\n        this._lastTarget = null;\n        this._lastOutputHeight = '';\n        this.addClass(CODE_CELL_CLASS);\n        const trans = this.translator.load('jupyterlab');\n        // Only save options not handled by parent constructor.\n        const rendermime = (this._rendermime = options.rendermime);\n        const contentFactory = this.contentFactory;\n        const model = this.model;\n        this.maxNumberOutputs = options.maxNumberOutputs;\n        // Note that modifying the below label warrants one to also modify\n        // the same in this._outputLengthHandler. Ideally, this label must\n        // have been a constant and used in both places but it is not done\n        // so because of limitations in the translation manager.\n        const ariaLabel = model.outputs.length === 0\n            ? trans.__('Code Cell Content')\n            : trans.__('Code Cell Content with Output');\n        this.node.setAttribute('aria-label', ariaLabel);\n        const output = (this._output = new OutputArea({\n            model: this.model.outputs,\n            rendermime,\n            contentFactory: contentFactory,\n            maxNumberOutputs: this.maxNumberOutputs,\n            translator: this.translator,\n            promptOverlay: true,\n            inputHistoryScope: options.inputHistoryScope\n        }));\n        output.node.addEventListener('keydown', this._detectCaretMovementInOuput);\n        output.addClass(CELL_OUTPUT_AREA_CLASS);\n        output.toggleScrolling.connect(() => {\n            this.outputsScrolled = !this.outputsScrolled;\n        });\n        output.initialize.connect(() => {\n            this.updatePromptOverlayIcon();\n        });\n        // Defer setting placeholder as OutputArea must be instantiated before initializing the DOM\n        this.placeholder = (_a = options.placeholder) !== null && _a !== void 0 ? _a : true;\n        model.outputs.changed.connect(this.onOutputChanged, this);\n        model.outputs.stateChanged.connect(this.onOutputChanged, this);\n        model.stateChanged.connect(this.onStateChanged, this);\n    }\n    /**\n     * Create children widgets.\n     */\n    initializeDOM() {\n        if (!this.placeholder) {\n            return;\n        }\n        super.initializeDOM();\n        this._updatePrompt();\n        // Insert the output before the cell footer.\n        const outputWrapper = (this._outputWrapper = new Panel());\n        outputWrapper.addClass(CELL_OUTPUT_WRAPPER_CLASS);\n        const outputCollapser = new OutputCollapser();\n        outputCollapser.addClass(CELL_OUTPUT_COLLAPSER_CLASS);\n        outputWrapper.addWidget(outputCollapser);\n        // Set a CSS if there are no outputs, and connect a signal for future\n        // changes to the number of outputs. This is for conditional styling\n        // if there are no outputs.\n        if (this.model.outputs.length === 0) {\n            this.addClass(NO_OUTPUTS_CLASS);\n        }\n        this._output.outputLengthChanged.connect(this._outputLengthHandler, this);\n        outputWrapper.addWidget(this._output);\n        const layout = this.layout;\n        const resizeHandle = new ResizeHandle(this.node);\n        resizeHandle.sizeChanged.connect(this._sizeChangedHandler, this);\n        layout.insertWidget(layout.widgets.length - 1, resizeHandle);\n        layout.insertWidget(layout.widgets.length - 1, outputWrapper);\n        if (this.model.isDirty) {\n            this.addClass(DIRTY_CLASS);\n        }\n        this._outputPlaceholder = new OutputPlaceholder({\n            callback: () => {\n                this.outputHidden = !this.outputHidden;\n            },\n            text: this.getOutputPlaceholderText(),\n            translator: this.translator\n        });\n        const layoutWrapper = outputWrapper.layout;\n        if (this.outputHidden) {\n            layoutWrapper.removeWidget(this._output);\n            layoutWrapper.addWidget(this._outputPlaceholder);\n            if (this.inputHidden && !outputWrapper.isHidden) {\n                this._outputWrapper.hide();\n            }\n        }\n        const trans = this.translator.load('jupyterlab');\n        const ariaLabel = this.model.outputs.length === 0\n            ? trans.__('Code Cell Content')\n            : trans.__('Code Cell Content with Output');\n        this.node.setAttribute('aria-label', ariaLabel);\n    }\n    getOutputPlaceholderText() {\n        var _a;\n        const firstOutput = this.model.outputs.get(0);\n        const outputData = firstOutput === null || firstOutput === void 0 ? void 0 : firstOutput.data;\n        if (!outputData) {\n            return undefined;\n        }\n        const supportedOutputTypes = [\n            'text/html',\n            'image/svg+xml',\n            'application/pdf',\n            'text/markdown',\n            'text/plain',\n            'application/vnd.jupyter.stderr',\n            'application/vnd.jupyter.stdout',\n            'text'\n        ];\n        const preferredOutput = supportedOutputTypes.find(mt => {\n            const data = firstOutput.data[mt];\n            return (Array.isArray(data) ? typeof data[0] : typeof data) === 'string';\n        });\n        const dataToDisplay = firstOutput.data[preferredOutput !== null && preferredOutput !== void 0 ? preferredOutput : ''];\n        if (dataToDisplay !== undefined) {\n            return (_a = (Array.isArray(dataToDisplay)\n                ? dataToDisplay\n                : dataToDisplay === null || dataToDisplay === void 0 ? void 0 : dataToDisplay.split('\\n'))) === null || _a === void 0 ? void 0 : _a.find(part => part !== '');\n        }\n        return undefined;\n    }\n    /**\n     * Initialize view state from model.\n     *\n     * #### Notes\n     * Should be called after construction. For convenience, returns this, so it\n     * can be chained in the construction, like `new Foo().initializeState();`\n     */\n    initializeState() {\n        super.initializeState();\n        this.loadScrolledState();\n        this._updatePrompt();\n        return this;\n    }\n    get headings() {\n        if (!this._headingsCache) {\n            const headings = [];\n            // Iterate over the code cell outputs to check for Markdown or HTML from which we can generate ToC headings...\n            const outputs = this.model.outputs;\n            for (let j = 0; j < outputs.length; j++) {\n                const m = outputs.get(j);\n                let htmlType = null;\n                let mdType = null;\n                Object.keys(m.data).forEach(t => {\n                    if (!mdType && TableOfContentsUtils.Markdown.isMarkdown(t)) {\n                        mdType = t;\n                    }\n                    else if (!htmlType && TableOfContentsUtils.isHTML(t)) {\n                        htmlType = t;\n                    }\n                });\n                // Parse HTML output\n                if (htmlType) {\n                    headings.push(...TableOfContentsUtils.getHTMLHeadings(this._rendermime.sanitizer.sanitize(m.data[htmlType])).map(heading => {\n                        return {\n                            ...heading,\n                            outputIndex: j,\n                            type: Cell.HeadingType.HTML\n                        };\n                    }));\n                }\n                else if (mdType) {\n                    headings.push(...TableOfContentsUtils.Markdown.getHeadings(m.data[mdType]).map(heading => {\n                        return {\n                            ...heading,\n                            outputIndex: j,\n                            type: Cell.HeadingType.Markdown\n                        };\n                    }));\n                }\n            }\n            this._headingsCache = headings;\n        }\n        return [...this._headingsCache];\n    }\n    /**\n     * Get the output area for the cell.\n     */\n    get outputArea() {\n        return this._output;\n    }\n    /**\n     * The view state of output being collapsed.\n     */\n    get outputHidden() {\n        return this._outputHidden;\n    }\n    set outputHidden(value) {\n        var _a;\n        if (this._outputHidden === value) {\n            return;\n        }\n        if (!this.placeholder) {\n            const layout = this._outputWrapper.layout;\n            if (value) {\n                layout.removeWidget(this._output);\n                layout.addWidget(this._outputPlaceholder);\n                if (this.inputHidden && !this._outputWrapper.isHidden) {\n                    this._outputWrapper.hide();\n                }\n                if (this._outputPlaceholder) {\n                    this._outputPlaceholder.text = (_a = this.getOutputPlaceholderText()) !== null && _a !== void 0 ? _a : '';\n                }\n            }\n            else {\n                if (this._outputWrapper.isHidden) {\n                    this._outputWrapper.show();\n                }\n                layout.removeWidget(this._outputPlaceholder);\n                layout.addWidget(this._output);\n            }\n        }\n        this._outputHidden = value;\n        if (this.syncCollapse) {\n            this.saveCollapseState();\n        }\n    }\n    /**\n     * Save view collapse state to model\n     */\n    saveCollapseState() {\n        // Because collapse state for a code cell involves two different pieces of\n        // metadata (the `collapsed` and `jupyter` metadata keys), we block reacting\n        // to changes in metadata until we have fully committed our changes.\n        // Otherwise setting one key can trigger a write to the other key to\n        // maintain the synced consistency.\n        this.model.sharedModel.transact(() => {\n            super.saveCollapseState();\n            const collapsed = this.model.getMetadata('collapsed');\n            if ((this.outputHidden && collapsed === true) ||\n                (!this.outputHidden && collapsed === undefined)) {\n                return;\n            }\n            // Do not set jupyter.outputs_hidden since it is redundant. See\n            // and https://github.com/jupyter/nbformat/issues/137\n            if (this.outputHidden) {\n                this.model.setMetadata('collapsed', true);\n            }\n            else {\n                this.model.deleteMetadata('collapsed');\n            }\n        }, false, 'silent-change');\n    }\n    /**\n     * Revert view collapse state from model.\n     *\n     * We consider the `collapsed` metadata key as the source of truth for outputs\n     * being hidden.\n     */\n    loadCollapseState() {\n        super.loadCollapseState();\n        this.outputHidden = !!this.model.getMetadata('collapsed');\n    }\n    /**\n     * Whether the output is in a scrolled state?\n     */\n    get outputsScrolled() {\n        return this._outputsScrolled;\n    }\n    set outputsScrolled(value) {\n        this.toggleClass('jp-mod-outputsScrolled', value);\n        this._outputsScrolled = value;\n        if (this.syncScrolled) {\n            this.saveScrolledState();\n        }\n        this.updatePromptOverlayIcon();\n    }\n    /**\n     * Update the Prompt Overlay Icon\n     */\n    updatePromptOverlayIcon() {\n        var _a;\n        const overlay = DOMUtils.findElement(this.node, 'jp-OutputArea-promptOverlay');\n        if (!overlay) {\n            return;\n        }\n        // If you are changing this, don't forget about svg.\n        const ICON_HEIGHT = 16 + 4 + 4; // 4px for padding\n        if (overlay.clientHeight <= ICON_HEIGHT) {\n            (_a = overlay.firstChild) === null || _a === void 0 ? void 0 : _a.remove();\n            return;\n        }\n        let overlayTitle;\n        if (this._outputsScrolled) {\n            expandIcon.element({\n                container: overlay\n            });\n            overlayTitle = 'Expand Output';\n        }\n        else {\n            collapseIcon.element({\n                container: overlay\n            });\n            overlayTitle = 'Collapse Output';\n        }\n        const trans = this.translator.load('jupyterlab');\n        overlay.title = trans.__(overlayTitle);\n    }\n    /**\n     * Save view collapse state to model\n     */\n    saveScrolledState() {\n        const current = this.model.getMetadata('scrolled');\n        if ((this.outputsScrolled && current === true) ||\n            (!this.outputsScrolled && current === undefined)) {\n            return;\n        }\n        if (this.outputsScrolled) {\n            this.model.setMetadata('scrolled', true);\n        }\n        else {\n            this.outputArea.node.style.height = '';\n            this.model.deleteMetadata('scrolled');\n        }\n    }\n    /**\n     * Revert view collapse state from model.\n     */\n    loadScrolledState() {\n        // We don't have the notion of 'auto' scrolled, so we make it false.\n        if (this.model.getMetadata('scrolled') === 'auto') {\n            this.outputsScrolled = false;\n        }\n        else {\n            this.outputsScrolled = !!this.model.getMetadata('scrolled');\n        }\n    }\n    /**\n     * Whether to sync the scrolled state to the cell model.\n     */\n    get syncScrolled() {\n        return this._syncScrolled;\n    }\n    set syncScrolled(value) {\n        if (this._syncScrolled === value) {\n            return;\n        }\n        this._syncScrolled = value;\n        if (value) {\n            this.loadScrolledState();\n        }\n    }\n    /**\n     * Handle the input being hidden.\n     *\n     * #### Notes\n     * This method is called by the case cell implementation and is\n     * subclasses here so the code cell can watch to see when input\n     * is hidden without accessing private state.\n     */\n    handleInputHidden(value) {\n        if (this.placeholder) {\n            return;\n        }\n        if (!value && this._outputWrapper.isHidden) {\n            this._outputWrapper.show();\n        }\n        else if (value && !this._outputWrapper.isHidden && this._outputHidden) {\n            this._outputWrapper.hide();\n        }\n    }\n    /**\n     * Clone the cell, using the same model.\n     */\n    clone() {\n        const constructor = this.constructor;\n        return new constructor({\n            model: this.model,\n            contentFactory: this.contentFactory,\n            rendermime: this._rendermime,\n            placeholder: false,\n            translator: this.translator\n        });\n    }\n    /**\n     * Clone the OutputArea alone, returning a simplified output area, using the same model.\n     */\n    cloneOutputArea() {\n        return new SimplifiedOutputArea({\n            model: this.model.outputs,\n            contentFactory: this.contentFactory,\n            rendermime: this._rendermime\n        });\n    }\n    /**\n     * Dispose of the resources used by the widget.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._output.outputLengthChanged.disconnect(this._outputLengthHandler, this);\n        this._output.node.removeEventListener('keydown', this._detectCaretMovementInOuput);\n        this._rendermime = null;\n        this._output = null;\n        this._outputWrapper = null;\n        this._outputPlaceholder = null;\n        super.dispose();\n    }\n    /**\n     * Handle changes in the model.\n     */\n    onStateChanged(model, args) {\n        switch (args.name) {\n            case 'executionCount':\n                this.model.executionState = 'idle';\n                this._updatePrompt();\n                break;\n            case 'executionState':\n                this._updatePrompt();\n                break;\n            case 'isDirty':\n                if (model.isDirty) {\n                    this.addClass(DIRTY_CLASS);\n                }\n                else {\n                    this.removeClass(DIRTY_CLASS);\n                }\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Callback on output changes\n     */\n    onOutputChanged() {\n        var _a;\n        this._headingsCache = null;\n        if (this._outputPlaceholder && this.outputHidden) {\n            this._outputPlaceholder.text = (_a = this.getOutputPlaceholderText()) !== null && _a !== void 0 ? _a : '';\n        }\n        // This is to hide/show icon on single line output.\n        this.updatePromptOverlayIcon();\n        // Clear output area when empty\n        const height = this.outputArea.node.style.height;\n        if (this.model.outputs.length === 0 && height !== '') {\n            this._lastOutputHeight = height;\n            this.outputArea.node.style.height = '';\n        }\n        else if (this.model.outputs.length > 0 && height === '') {\n            this.outputArea.node.style.height = this._lastOutputHeight;\n        }\n    }\n    /**\n     * Handle changes in the metadata.\n     */\n    onMetadataChanged(model, args) {\n        switch (args.key) {\n            case 'scrolled':\n                if (this.syncScrolled) {\n                    this.loadScrolledState();\n                }\n                break;\n            case 'collapsed':\n                if (this.syncCollapse) {\n                    this.loadCollapseState();\n                }\n                break;\n            default:\n                break;\n        }\n        super.onMetadataChanged(model, args);\n    }\n    _updatePrompt() {\n        let prompt;\n        if (this.model.executionState == 'running') {\n            prompt = '*';\n        }\n        else {\n            prompt = `${this.model.executionCount || ''}`;\n        }\n        this._setPrompt(prompt);\n    }\n    /**\n     * Handle changes in the number of outputs in the output area.\n     */\n    _outputLengthHandler(sender, args) {\n        const force = args === 0 ? true : false;\n        this.toggleClass(NO_OUTPUTS_CLASS, force);\n        const trans = this.translator.load('jupyterlab');\n        const ariaLabel = force\n            ? trans.__('Code Cell Content')\n            : trans.__('Code Cell Content with Output');\n        this.node.setAttribute('aria-label', ariaLabel);\n    }\n    /**\n     * Handle changes in input/output proportions in side-by-side mode.\n     */\n    _sizeChangedHandler(sender) {\n        this._displayChanged.emit();\n    }\n}\n/**\n * The namespace for the `CodeCell` class statics.\n */\n(function (CodeCell) {\n    /**\n     * Execute a cell given a client session.\n     */\n    async function execute(cell, sessionContext, metadata) {\n        var _a;\n        const model = cell.model;\n        const code = model.sharedModel.getSource();\n        if (!code.trim() || !((_a = sessionContext.session) === null || _a === void 0 ? void 0 : _a.kernel)) {\n            model.sharedModel.transact(() => {\n                model.clearExecution();\n            }, false, 'silent-change');\n            return;\n        }\n        const cellId = { cellId: model.sharedModel.getId() };\n        metadata = {\n            ...model.metadata,\n            ...metadata,\n            ...cellId\n        };\n        const { recordTiming } = metadata;\n        model.sharedModel.transact(() => {\n            model.clearExecution();\n            cell.outputHidden = false;\n        }, false, 'silent-change');\n        // note: in future we would like to distinguish running from scheduled\n        model.executionState = 'running';\n        model.trusted = true;\n        let future;\n        try {\n            const msgPromise = OutputArea.execute(code, cell.outputArea, sessionContext, metadata);\n            // cell.outputArea.future assigned synchronously in `execute`\n            if (recordTiming) {\n                const recordTimingHook = (msg) => {\n                    let label;\n                    switch (msg.header.msg_type) {\n                        case 'status':\n                            label = `status.${msg.content.execution_state}`;\n                            break;\n                        case 'execute_input':\n                            label = 'execute_input';\n                            break;\n                        default:\n                            return true;\n                    }\n                    // If the data is missing, estimate it to now\n                    // Date was added in 5.1: https://jupyter-client.readthedocs.io/en/stable/messaging.html#message-header\n                    const value = msg.header.date || new Date().toISOString();\n                    const timingInfo = Object.assign({}, model.getMetadata('execution'));\n                    timingInfo[`iopub.${label}`] = value;\n                    model.setMetadata('execution', timingInfo);\n                    return true;\n                };\n                cell.outputArea.future.registerMessageHook(recordTimingHook);\n            }\n            else {\n                model.deleteMetadata('execution');\n            }\n            // Save this execution's future so we can compare in the catch below.\n            future = cell.outputArea.future;\n            const msg = (await msgPromise);\n            model.executionCount = msg.content.execution_count;\n            if (recordTiming) {\n                const timingInfo = Object.assign({}, model.getMetadata('execution'));\n                const started = msg.metadata.started;\n                // Started is not in the API, but metadata IPyKernel sends\n                if (started) {\n                    timingInfo['shell.execute_reply.started'] = started;\n                }\n                // Per above, the 5.0 spec does not assume date, so we estimate is required\n                const finished = msg.header.date;\n                timingInfo['shell.execute_reply'] =\n                    finished || new Date().toISOString();\n                model.setMetadata('execution', timingInfo);\n            }\n            return msg;\n        }\n        catch (e) {\n            // If we started executing, and the cell is still indicating this\n            // execution, clear the prompt.\n            if (future && !cell.isDisposed && cell.outputArea.future === future) {\n                cell.model.executionState = 'idle';\n                if (recordTiming && future.isDisposed) {\n                    // Record the time when the cell execution was aborted\n                    const timingInfo = Object.assign({}, model.getMetadata('execution'));\n                    timingInfo['execution_failed'] = new Date().toISOString();\n                    model.setMetadata('execution', timingInfo);\n                }\n            }\n            throw e;\n        }\n    }\n    CodeCell.execute = execute;\n})(CodeCell || (CodeCell = {}));\n/**\n * `AttachmentsCell` - A base class for a cell widget that allows\n *  attachments to be drag/drop'd or pasted onto it\n */\nexport class AttachmentsCell extends Cell {\n    /**\n     * Handle the DOM events for the widget.\n     *\n     * @param event - The DOM event sent to the widget.\n     *\n     * #### Notes\n     * This method implements the DOM `EventListener` interface and is\n     * called in response to events on the notebook panel's node. It should\n     * not be called directly by user code.\n     */\n    handleEvent(event) {\n        switch (event.type) {\n            case 'lm-dragover':\n                this._evtDragOver(event);\n                break;\n            case 'lm-drop':\n                this._evtDrop(event);\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Get the editor options at initialization.\n     *\n     * @returns Editor options\n     */\n    getEditorOptions() {\n        var _a, _b;\n        const base = (_a = super.getEditorOptions()) !== null && _a !== void 0 ? _a : {};\n        base.extensions = [\n            ...((_b = base.extensions) !== null && _b !== void 0 ? _b : []),\n            EditorView.domEventHandlers({\n                dragenter: (event) => {\n                    event.preventDefault();\n                },\n                dragover: (event) => {\n                    event.preventDefault();\n                },\n                drop: (event) => {\n                    this._evtNativeDrop(event);\n                },\n                paste: (event) => {\n                    this._evtPaste(event);\n                }\n            })\n        ];\n        return base;\n    }\n    /**\n     * Handle `after-attach` messages for the widget.\n     */\n    onAfterAttach(msg) {\n        super.onAfterAttach(msg);\n        const node = this.node;\n        node.addEventListener('lm-dragover', this);\n        node.addEventListener('lm-drop', this);\n    }\n    /**\n     * A message handler invoked on a `'before-detach'`\n     * message\n     */\n    onBeforeDetach(msg) {\n        const node = this.node;\n        node.removeEventListener('lm-dragover', this);\n        node.removeEventListener('lm-drop', this);\n        super.onBeforeDetach(msg);\n    }\n    _evtDragOver(event) {\n        const supportedMimeType = some(imageRendererFactory.mimeTypes, mimeType => {\n            if (!event.mimeData.hasData(CONTENTS_MIME_RICH)) {\n                return false;\n            }\n            const data = event.mimeData.getData(CONTENTS_MIME_RICH);\n            return data.model.mimetype === mimeType;\n        });\n        if (!supportedMimeType) {\n            return;\n        }\n        event.preventDefault();\n        event.stopPropagation();\n        event.dropAction = event.proposedAction;\n    }\n    /**\n     * Handle the `paste` event for the widget\n     */\n    _evtPaste(event) {\n        var _a;\n        const isEditable = (_a = this.model.getMetadata('editable')) !== null && _a !== void 0 ? _a : true;\n        if (event.clipboardData && isEditable) {\n            const items = event.clipboardData.items;\n            for (let i = 0; i < items.length; i++) {\n                if (items[i].type === 'text/plain') {\n                    // Skip if this text is the path to a file\n                    if (i < items.length - 1 && items[i + 1].kind === 'file') {\n                        continue;\n                    }\n                    items[i].getAsString(text => {\n                        var _a, _b;\n                        (_b = (_a = this.editor).replaceSelection) === null || _b === void 0 ? void 0 : _b.call(_a, text.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n'));\n                    });\n                }\n                this._attachFiles(event.clipboardData.items);\n            }\n        }\n        event.preventDefault();\n    }\n    /**\n     * Handle the `drop` event for the widget\n     */\n    _evtNativeDrop(event) {\n        if (event.dataTransfer) {\n            this._attachFiles(event.dataTransfer.items);\n        }\n        event.preventDefault();\n    }\n    /**\n     * Handle the `'lm-drop'` event for the widget.\n     */\n    _evtDrop(event) {\n        const supportedMimeTypes = event.mimeData.types().filter(mimeType => {\n            if (mimeType === CONTENTS_MIME_RICH) {\n                const data = event.mimeData.getData(CONTENTS_MIME_RICH);\n                return (imageRendererFactory.mimeTypes.indexOf(data.model.mimetype) !== -1);\n            }\n            return imageRendererFactory.mimeTypes.indexOf(mimeType) !== -1;\n        });\n        if (supportedMimeTypes.length === 0) {\n            return;\n        }\n        event.preventDefault();\n        event.stopPropagation();\n        if (event.proposedAction === 'none') {\n            event.dropAction = 'none';\n            return;\n        }\n        event.dropAction = 'copy';\n        for (const mimeType of supportedMimeTypes) {\n            if (mimeType === CONTENTS_MIME_RICH) {\n                const { model, withContent } = event.mimeData.getData(CONTENTS_MIME_RICH);\n                if (model.type === 'file') {\n                    const URI = this._generateURI(model.name);\n                    this.updateCellSourceWithAttachment(model.name, URI);\n                    void withContent().then(fullModel => {\n                        this.model.attachments.set(URI, {\n                            [fullModel.mimetype]: fullModel.content\n                        });\n                    });\n                }\n            }\n            else {\n                // Pure mimetype, no useful name to infer\n                const URI = this._generateURI();\n                this.model.attachments.set(URI, {\n                    [mimeType]: event.mimeData.getData(mimeType)\n                });\n                this.updateCellSourceWithAttachment(URI, URI);\n            }\n        }\n    }\n    /**\n     * Attaches all DataTransferItems (obtained from\n     * clipboard or native drop events) to the cell\n     */\n    _attachFiles(items) {\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            if (item.kind === 'file') {\n                const blob = item.getAsFile();\n                if (blob) {\n                    this._attachFile(blob);\n                }\n            }\n        }\n    }\n    /**\n     * Takes in a file object and adds it to\n     * the cell attachments\n     */\n    _attachFile(blob) {\n        const reader = new FileReader();\n        reader.onload = evt => {\n            const { href, protocol } = URLExt.parse(reader.result);\n            if (protocol !== 'data:') {\n                return;\n            }\n            const dataURIRegex = /([\\w+\\/\\+]+)?(?:;(charset=[\\w\\d-]*|base64))?,(.*)/;\n            const matches = dataURIRegex.exec(href);\n            if (!matches || matches.length !== 4) {\n                return;\n            }\n            const mimeType = matches[1];\n            const encodedData = matches[3];\n            const bundle = { [mimeType]: encodedData };\n            const URI = this._generateURI(blob.name);\n            if (mimeType.startsWith('image/')) {\n                this.model.attachments.set(URI, bundle);\n                this.updateCellSourceWithAttachment(blob.name, URI);\n            }\n        };\n        reader.onerror = evt => {\n            console.error(`Failed to attach ${blob.name}` + evt);\n        };\n        reader.readAsDataURL(blob);\n    }\n    /**\n     * Generates a unique URI for a file\n     * while preserving the file extension.\n     */\n    _generateURI(name = '') {\n        const lastIndex = name.lastIndexOf('.');\n        return lastIndex !== -1\n            ? UUID.uuid4().concat(name.substring(lastIndex))\n            : UUID.uuid4();\n    }\n}\n/** ****************************************************************************\n * MarkdownCell\n ******************************************************************************/\n/**\n * A widget for a Markdown cell.\n *\n * #### Notes\n * Things get complicated if we want the rendered text to update\n * any time the text changes, the text editor model changes,\n * or the input area model changes.  We don't support automatically\n * updating the rendered text in all of these cases.\n */\nexport class MarkdownCell extends AttachmentsCell {\n    /**\n     * Construct a Markdown cell widget.\n     */\n    constructor(options) {\n        var _a, _b, _c, _d;\n        super({ ...options, placeholder: true });\n        this._headingsCache = null;\n        this._headingCollapsedChanged = new Signal(this);\n        this._prevText = '';\n        this._rendered = true;\n        this._renderedChanged = new Signal(this);\n        this._showEditorForReadOnlyMarkdown = true;\n        this.addClass(MARKDOWN_CELL_CLASS);\n        this.model.contentChanged.connect(this.onContentChanged, this);\n        const trans = this.translator.load('jupyterlab');\n        this.node.setAttribute('aria-label', trans.__('Markdown Cell Content'));\n        // Ensure we can resolve attachments:\n        this._rendermime = options.rendermime.clone({\n            resolver: new AttachmentsResolver({\n                parent: (_a = options.rendermime.resolver) !== null && _a !== void 0 ? _a : undefined,\n                model: this.model.attachments\n            })\n        });\n        this._renderer = this._rendermime.createRenderer('text/markdown');\n        this._renderer.addClass(MARKDOWN_OUTPUT_CLASS);\n        // Check if heading cell is set to be collapsed\n        this._headingCollapsed = ((_b = this.model.getMetadata(MARKDOWN_HEADING_COLLAPSED)) !== null && _b !== void 0 ? _b : false);\n        this._showEditorForReadOnlyMarkdown =\n            (_c = options.showEditorForReadOnlyMarkdown) !== null && _c !== void 0 ? _c : MarkdownCell.defaultShowEditorForReadOnlyMarkdown;\n        // Defer setting placeholder as the renderer must be instantiated before initializing the DOM\n        this.placeholder = (_d = options.placeholder) !== null && _d !== void 0 ? _d : true;\n        this._monitor = new ActivityMonitor({\n            signal: this.model.contentChanged,\n            timeout: RENDER_TIMEOUT\n        });\n        // Throttle the rendering rate of the widget.\n        this.ready\n            .then(() => {\n            if (this.isDisposed) {\n                // Bail early\n                return;\n            }\n            this._monitor.activityStopped.connect(() => {\n                if (this._rendered) {\n                    this.update();\n                }\n            }, this);\n        })\n            .catch(reason => {\n            console.error('Failed to be ready', reason);\n        });\n    }\n    /**\n     * Text that represents the highest heading (i.e. lowest level) if cell is a heading.\n     * Returns empty string if not a heading.\n     */\n    get headingInfo() {\n        // Use table of content algorithm for consistency\n        const headings = this.headings;\n        if (headings.length > 0) {\n            // Return the highest level\n            const { text, level } = headings.reduce((prev, curr) => (prev.level <= curr.level ? prev : curr), headings[0]);\n            return { text, level };\n        }\n        else {\n            return { text: '', level: -1 };\n        }\n    }\n    get headings() {\n        if (!this._headingsCache) {\n            // Use table of content algorithm for consistency\n            const headings = TableOfContentsUtils.Markdown.getHeadings(this.model.sharedModel.getSource());\n            this._headingsCache = headings.map(h => {\n                return { ...h, type: Cell.HeadingType.Markdown };\n            });\n        }\n        return [...this._headingsCache];\n    }\n    /**\n     * Whether the heading is collapsed or not.\n     */\n    get headingCollapsed() {\n        return this._headingCollapsed;\n    }\n    set headingCollapsed(value) {\n        var _a;\n        if (this._headingCollapsed !== value) {\n            this._headingCollapsed = value;\n            if (value) {\n                this.model.setMetadata(MARKDOWN_HEADING_COLLAPSED, value);\n            }\n            else if (this.model.getMetadata(MARKDOWN_HEADING_COLLAPSED) !== 'undefined') {\n                this.model.deleteMetadata(MARKDOWN_HEADING_COLLAPSED);\n            }\n            const collapseButton = (_a = this.inputArea) === null || _a === void 0 ? void 0 : _a.promptNode.getElementsByClassName(HEADING_COLLAPSER_CLASS)[0];\n            if (collapseButton) {\n                if (value) {\n                    collapseButton.classList.add('jp-mod-collapsed');\n                }\n                else {\n                    collapseButton.classList.remove('jp-mod-collapsed');\n                }\n            }\n            this.renderCollapseButtons(this._renderer);\n            this._headingCollapsedChanged.emit(this._headingCollapsed);\n        }\n    }\n    /**\n     * Number of collapsed sub cells.\n     */\n    get numberChildNodes() {\n        return this._numberChildNodes;\n    }\n    set numberChildNodes(value) {\n        this._numberChildNodes = value;\n        this.renderCollapseButtons(this._renderer);\n    }\n    /**\n     * Signal emitted when the cell collapsed state changes.\n     */\n    get headingCollapsedChanged() {\n        return this._headingCollapsedChanged;\n    }\n    /**\n     * Whether the cell is rendered.\n     */\n    get rendered() {\n        return this._rendered;\n    }\n    set rendered(value) {\n        // Show cell as rendered when cell is not editable\n        if (this.readOnly && this._showEditorForReadOnlyMarkdown === false) {\n            value = true;\n        }\n        if (value === this._rendered) {\n            return;\n        }\n        this._rendered = value;\n        this._handleRendered()\n            .then(() => {\n            // If the rendered state changed, raise an event.\n            this._displayChanged.emit();\n            this._renderedChanged.emit(this._rendered);\n        })\n            .catch(reason => {\n            console.error('Failed to render', reason);\n        });\n    }\n    /**\n     * Signal emitted when the markdown cell rendered state changes\n     */\n    get renderedChanged() {\n        return this._renderedChanged;\n    }\n    /*\n     * Whether the Markdown editor is visible in read-only mode.\n     */\n    get showEditorForReadOnly() {\n        return this._showEditorForReadOnlyMarkdown;\n    }\n    set showEditorForReadOnly(value) {\n        this._showEditorForReadOnlyMarkdown = value;\n        if (value === false) {\n            this.rendered = true;\n        }\n    }\n    /**\n     * Renderer\n     */\n    get renderer() {\n        return this._renderer;\n    }\n    /**\n     * Dispose of the resources held by the widget.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._monitor.dispose();\n        super.dispose();\n    }\n    /**\n     * Create children widgets.\n     */\n    initializeDOM() {\n        if (!this.placeholder) {\n            return;\n        }\n        super.initializeDOM();\n        this.renderCollapseButtons(this._renderer);\n        this._handleRendered().catch(reason => {\n            console.error('Failed to render', reason);\n        });\n    }\n    maybeCreateCollapseButton() {\n        var _a;\n        const { level } = this.headingInfo;\n        if (level > 0 &&\n            ((_a = this.inputArea) === null || _a === void 0 ? void 0 : _a.promptNode.getElementsByClassName(HEADING_COLLAPSER_CLASS).length) == 0) {\n            let collapseButton = this.inputArea.promptNode.appendChild(document.createElement('button'));\n            collapseButton.className = `jp-Button ${HEADING_COLLAPSER_CLASS}`;\n            collapseButton.setAttribute('data-heading-level', level.toString());\n            if (this._headingCollapsed) {\n                collapseButton.classList.add('jp-mod-collapsed');\n            }\n            else {\n                collapseButton.classList.remove('jp-mod-collapsed');\n            }\n            collapseButton.onclick = (event) => {\n                this.headingCollapsed = !this.headingCollapsed;\n            };\n        }\n    }\n    /**\n     * Create, update or remove the hidden cells button.\n     * Note that the actual visibility is controlled in Static Notebook by toggling jp-mod-showHiddenCellsButton class.\n     */\n    maybeCreateOrUpdateExpandButton() {\n        const showHiddenCellsButtonList = this.node.getElementsByClassName(SHOW_HIDDEN_CELLS_CLASS);\n        let trans = this.translator.load('jupyterlab');\n        let buttonText = trans._n('%1 cell hidden', '%1 cells hidden', this._numberChildNodes);\n        let needToCreateButton = this.headingCollapsed &&\n            this._numberChildNodes > 0 &&\n            showHiddenCellsButtonList.length == 0;\n        if (needToCreateButton) {\n            const newShowHiddenCellsButton = document.createElement('button');\n            newShowHiddenCellsButton.className = `jp-mod-minimal jp-Button ${SHOW_HIDDEN_CELLS_CLASS}`;\n            addIcon.render(newShowHiddenCellsButton);\n            const buttonTextElement = document.createElement('div');\n            buttonTextElement.textContent = buttonText;\n            newShowHiddenCellsButton.appendChild(buttonTextElement);\n            newShowHiddenCellsButton.onclick = () => {\n                this.headingCollapsed = false;\n            };\n            this.node.appendChild(newShowHiddenCellsButton);\n        }\n        let needToUpdateButtonText = this.headingCollapsed &&\n            this._numberChildNodes > 0 &&\n            showHiddenCellsButtonList.length == 1;\n        if (needToUpdateButtonText) {\n            showHiddenCellsButtonList[0].childNodes[1].textContent = buttonText;\n        }\n        let needToRemoveButton = !(this.headingCollapsed && this._numberChildNodes > 0);\n        if (needToRemoveButton) {\n            for (const button of showHiddenCellsButtonList) {\n                this.node.removeChild(button);\n            }\n        }\n    }\n    /**\n     * Callback on content changed\n     */\n    onContentChanged() {\n        super.onContentChanged();\n        this._headingsCache = null;\n    }\n    /**\n     * Render the collapse button for heading cells,\n     * and for collapsed heading cells render the \"expand hidden cells\"\n     * button.\n     */\n    renderCollapseButtons(widget) {\n        this.node.classList.toggle(MARKDOWN_HEADING_COLLAPSED, this._headingCollapsed);\n        this.maybeCreateCollapseButton();\n        this.maybeCreateOrUpdateExpandButton();\n    }\n    /**\n     * Render an input instead of the text editor.\n     */\n    renderInput(widget) {\n        this.addClass(RENDERED_CLASS);\n        if (!this.placeholder && !this.isDisposed) {\n            this.renderCollapseButtons(widget);\n            this.inputArea.renderInput(widget);\n        }\n    }\n    /**\n     * Show the text editor instead of rendered input.\n     */\n    showEditor() {\n        this.removeClass(RENDERED_CLASS);\n        if (!this.placeholder && !this.isDisposed) {\n            this.inputArea.showEditor();\n            // if this is going to be a heading, place the cursor accordingly\n            let numHashAtStart = (this.model.sharedModel\n                .getSource()\n                .match(/^#+/g) || [''])[0].length;\n            if (numHashAtStart > 0) {\n                this.inputArea.editor.setCursorPosition({\n                    column: numHashAtStart + 1,\n                    line: 0\n                }, { scroll: false });\n            }\n        }\n    }\n    /*\n     * Handle `update-request` messages.\n     */\n    onUpdateRequest(msg) {\n        // Make sure we are properly rendered.\n        this._handleRendered().catch(reason => {\n            console.error('Failed to render', reason);\n        });\n        super.onUpdateRequest(msg);\n    }\n    /**\n     * Modify the cell source to include a reference to the attachment.\n     */\n    updateCellSourceWithAttachment(attachmentName, URI) {\n        var _a, _b;\n        const textToBeAppended = `![${attachmentName}](attachment:${URI !== null && URI !== void 0 ? URI : attachmentName})`;\n        // TODO this should be done on the model...\n        (_b = (_a = this.editor) === null || _a === void 0 ? void 0 : _a.replaceSelection) === null || _b === void 0 ? void 0 : _b.call(_a, textToBeAppended);\n    }\n    /**\n     * Handle the rendered state.\n     */\n    async _handleRendered() {\n        if (!this._rendered) {\n            this.showEditor();\n        }\n        else {\n            // TODO: It would be nice for the cell to provide a way for\n            // its consumers to hook into when the rendering is done.\n            await this._updateRenderedInput();\n            if (this._rendered) {\n                // The rendered flag may be updated in the mean time\n                this.renderInput(this._renderer);\n            }\n        }\n    }\n    /**\n     * Update the rendered input.\n     */\n    _updateRenderedInput() {\n        if (this.placeholder) {\n            return Promise.resolve();\n        }\n        const model = this.model;\n        const text = (model && model.sharedModel.getSource()) || DEFAULT_MARKDOWN_TEXT;\n        // Do not re-render if the text has not changed.\n        if (text !== this._prevText) {\n            const mimeModel = new MimeModel({ data: { 'text/markdown': text } });\n            this._prevText = text;\n            return this._renderer.renderModel(mimeModel);\n        }\n        return Promise.resolve();\n    }\n    /**\n     * Clone the cell, using the same model.\n     */\n    clone() {\n        const constructor = this.constructor;\n        return new constructor({\n            model: this.model,\n            contentFactory: this.contentFactory,\n            rendermime: this._rendermime,\n            placeholder: false,\n            translator: this.translator\n        });\n    }\n}\n/**\n * The namespace for the `CodeCell` class statics.\n */\n(function (MarkdownCell) {\n    /**\n     * Default value for showEditorForReadOnlyMarkdown.\n     */\n    MarkdownCell.defaultShowEditorForReadOnlyMarkdown = true;\n})(MarkdownCell || (MarkdownCell = {}));\n/** ****************************************************************************\n * RawCell\n ******************************************************************************/\n/**\n * A widget for a raw cell.\n */\nexport class RawCell extends Cell {\n    /**\n     * Construct a raw cell widget.\n     */\n    constructor(options) {\n        super(options);\n        this.addClass(RAW_CELL_CLASS);\n        const trans = this.translator.load('jupyterlab');\n        this.node.setAttribute('aria-label', trans.__('Raw Cell Content'));\n    }\n    /**\n     * Clone the cell, using the same model.\n     */\n    clone() {\n        const constructor = this.constructor;\n        return new constructor({\n            model: this.model,\n            contentFactory: this.contentFactory,\n            placeholder: false,\n            translator: this.translator\n        });\n    }\n}\n//# sourceMappingURL=widget.js.map"],"names":["DRAG_IMAGE_CLASS","SINGLE_DRAG_IMAGE_CLASS","CELL_DRAG_CONTENT_CLASS","CELL_DRAG_PROMPT_CLASS","CELL_DRAG_MULTIPLE_BACK","CellDragUtils","findCell","node","cells","isCellNode","cellIndex","parentElement","index","cell","detectTargetArea","target","_a","_b","targetArea","editorWidget","contains","promptNode","shouldStartDrag","prevX","prevY","nextX","nextY","dx","Math","abs","dy","createCellDragImage","activeCell","selectedCells","count","length","promptNumber","model","type","executionCount","toString","cellContent","sharedModel","getSource","split","slice","VirtualDOM","realize","h","div","className","span","Collapser","ReactWidget","constructor","super","this","addClass","collapsed","render","onClick","e","handleClick","InputCollapser","parent","inputHidden","update","OutputCollapser","outputHidden","area","ElementExt","scrollIntoViewIfNeeded","CellHeader","Widget","CellFooter","InputArea","options","contentFactory","editorOptions","prompt","_prompt","createInputPrompt","editor","_editor","CodeEditorWrapper","factory","editorFactory","layout","PanelLayout","addWidget","renderedInput","_rendered","renderInput","widget","hide","showEditor","show","setPrompt","value","dispose","isDisposed","ContentFactory","InputPrompt","_executionCount","textContent","AttachmentsModel","_map","ObservableMap","_isDisposed","_stateChanged","Signal","_changed","_serialized","_changeGuard","defaultContentFactory","values","key","Object","keys","undefined","set","changed","connect","_onMapChanged","stateChanged","clearData","has","get","item","_createItem","remove","delete","clear","forEach","fromJSON","toJSON","ret","createAttachmentModel","_onGenericChange","sender","args","emit","AttachmentModel","AttachmentsResolver","_parent","_model","resolveUrl","url","startsWith","getDownloadUrl","path","attachment","data","mimeType","imageRendererFactory","mimeTypes","indexOf","Error","isLocal","_c","call","globalModelDBMutex","createMutex","isCodeCellModel","isMarkdownCellModel","isRawCellModel","CellModel","CodeEditor","Model","cell_type","others","createStandaloneCell","id","contentChanged","_metadataChanged","_trusted","standaloneModel","trusted","getMetadata","onGenericChange","metadataChanged","_onMetadataChanged","getId","metadata","newValue","oldValue","onTrustedChanged","disconnect","deleteMetadata","setMetadata","change","AttachmentsCellModel","getAttachments","_attachments","createAttachmentsModel","_onAttachmentsChange","_onSharedModelChanged","attachments","event","setAttachments","slot","attachmentsChange","RawCellModel","MarkdownCellModel","CodeCellModel","_executedCode","_isDirty","outputs","getOutputs","_outputs","createOutputArea","onOutputsChange","execution_count","executionState","isDirty","dirty","_setDirty","clearExecution","newTrusted","codeCell","name","output","newValues","streamText","textEvent","removeStreamOutput","newIndex","start","appendStreamOutput","map","updateOutputs","oldIndex","oldValues","streamOutputChange","insert","outputsChange","retain","i","add","executionCountChange","executionStateChange","sourceChange","trim","v","OutputAreaModel","Placeholder","document","createElement","trans","translator","nullTranslator","load","innerNode","promptClass","insertAdjacentHTML","outerHTML","_cell","classList","title","__","container","appendChild","_textContent","innerText","text","ellipsesIcon","element","elementPosition","height","width","_callback","callback","t","onAfterAttach","msg","addEventListener","onBeforeDetach","removeEventListener","InputPlaceholder","OutputPlaceholder","SELECTED_HIGHLIGHT_CLASS","CellSearchProvider","EditorSearchProvider","inViewport","signalToPromise","inViewportChanged","then","cmHandler","setEditor","CodeCellSearchProvider","currentProviderIndex","outputsProvider","outputArea","_onOutputsChanged","widgets","catch","reason","console","error","outputLengthChanged","disposed","matchesCount","isActive","reduce","sum","provider","clearHighlight","Promise","all","highlightNext","loop","from","currentIndex","matches","match","currentMatchIndex","highlightPrevious","startQuery","query","filters","endQuery","replaceAllMatches","newText","resolve","replaceCurrentMatch","changes","GenericSearchProvider","MarkdownCellSearchProvider","_unrenderedByHighlight","renderedProvider","renderer","rendered","waitForRendered","renderedChanged","onRenderedChanged","result","setCursorPosition","column","line","createCellSearchProvider","isPlaceholder","CELL_RESIZED_CLASS","ResizeHandle","targetNode","_isActive","_isDragging","sizeChanged","_resizer","Throttler","_resize","handleEvent","parentNode","childNodes","documentElement","style","setProperty","window","invoke","x","getBoundingClientRect","ratio","clientX","normalized","max","min","CELL_OUTPUT_WRAPPER_CLASS","DIRTY_CLASS","MARKDOWN_HEADING_COLLAPSED","HEADING_COLLAPSER_CLASS","SHOW_HIDDEN_CELLS_CLASS","RENDERED_CLASS","NO_OUTPUTS_CLASS","CONTENTS_MIME_RICH","Cell","_d","_displayChanged","_scrollRequested","_scrollHandlerExtension","EditorView","scrollHandler","of","view","range","preventDefault","_inViewport","defaultPrevented","scrollWithinCell","dispatch","effects","scrollIntoView","_editorConfig","_editorExtensions","_inputHidden","_inViewportChanged","_readOnly","_ready","PromiseDelegate","_resizeDebouncer","Debouncer","_syncCollapse","_syncEditable","searchWithCM","editorConfig","editorExtensions","push","_placeholder","placeholder","onMetadataChanged","initializeState","loadCollapseState","loadEditableState","displayChanged","initializeDOM","_inputPlaceholder","firstElementChild","_input","headings","Array","inputArea","readOnly","syncEditable","saveEditableState","current","ready","promise","_setPrompt","_inputWrapper","syncCollapse","saveCollapseState","handleInputHidden","jupyter","source_hidden","clone","updateEditorConfig","setOptions","scrollRequested","header","createCellHeader","inputWrapper","Panel","inputCollapser","input","getEditorOptions","footer","createCellFooter","config","extensions","onBeforeAttach","onActivateRequest","focus","onResize","onUpdateRequest","getOption","setOption","onContentChanged","HeadingType","_editorFactory","createOutputPrompt","OutputPrompt","createStdin","Stdin","CodeCellLayout","beforeOutputArea","outputAreaWrapper","MessageLoop","sendMessage","insertBefore","isHidden","setFlag","Flag","IsVisible","Msg","AfterAttach","onAfterDetach","hasClass","isConnected","BeforeDetach","removeChild","CodeCell","_detectCaretMovementInOuput","HTMLElement","_lastTarget","_lastOnCaretMovedHandler","onCaretMoved","scroller","once","setTimeout","_headingsCache","_outputHidden","_outputWrapper","_outputPlaceholder","_syncScrolled","_lastOutputHeight","rendermime","_rendermime","maxNumberOutputs","ariaLabel","setAttribute","_output","OutputArea","promptOverlay","inputHistoryScope","toggleScrolling","outputsScrolled","initialize","updatePromptOverlayIcon","onOutputChanged","onStateChanged","_updatePrompt","outputWrapper","outputCollapser","_outputLengthHandler","resizeHandle","_sizeChangedHandler","insertWidget","getOutputPlaceholderText","layoutWrapper","removeWidget","firstOutput","preferredOutput","find","mt","isArray","dataToDisplay","part","loadScrolledState","j","m","htmlType","mdType","TableOfContentsUtils","Markdown","isMarkdown","isHTML","getHTMLHeadings","sanitizer","sanitize","heading","outputIndex","HTML","getHeadings","transact","_outputsScrolled","toggleClass","syncScrolled","saveScrolledState","overlay","DOMUtils","findElement","clientHeight","firstChild","overlayTitle","expandIcon","collapseIcon","cloneOutputArea","SimplifiedOutputArea","removeClass","force","execute","async","sessionContext","code","session","kernel","cellId","recordTiming","future","msgPromise","recordTimingHook","label","msg_type","content","execution_state","date","Date","toISOString","timingInfo","assign","registerMessageHook","started","finished","AttachmentsCell","_evtDragOver","_evtDrop","base","domEventHandlers","dragenter","dragover","drop","_evtNativeDrop","paste","_evtPaste","some","mimeData","hasData","getData","mimetype","stopPropagation","dropAction","proposedAction","isEditable","clipboardData","items","kind","getAsString","replaceSelection","replace","_attachFiles","dataTransfer","supportedMimeTypes","types","filter","withContent","URI","_generateURI","updateCellSourceWithAttachment","fullModel","blob","getAsFile","_attachFile","reader","FileReader","onload","evt","href","protocol","URLExt","parse","exec","encodedData","bundle","onerror","readAsDataURL","lastIndex","lastIndexOf","UUID","uuid4","concat","substring","MarkdownCell","_headingCollapsedChanged","_prevText","_renderedChanged","_showEditorForReadOnlyMarkdown","resolver","_renderer","createRenderer","_headingCollapsed","showEditorForReadOnlyMarkdown","defaultShowEditorForReadOnlyMarkdown","_monitor","ActivityMonitor","signal","timeout","activityStopped","headingInfo","level","prev","curr","headingCollapsed","collapseButton","getElementsByClassName","renderCollapseButtons","numberChildNodes","_numberChildNodes","headingCollapsedChanged","_handleRendered","showEditorForReadOnly","maybeCreateCollapseButton","onclick","maybeCreateOrUpdateExpandButton","showHiddenCellsButtonList","buttonText","_n","newShowHiddenCellsButton","addIcon","buttonTextElement","button","toggle","numHashAtStart","scroll","attachmentName","textToBeAppended","_updateRenderedInput","mimeModel","MimeModel","renderModel","RawCell"],"sourceRoot":""}